import{j as e}from"./ui-ZHFf5B17.js";import{r as c}from"./vendor-CcMVubkO.js";import{B as y}from"./button-DYC7yMVq.js";import{I as n}from"./input-DqOfVTcn.js";import{L as t}from"./label-DbqhUtKI.js";import{C as _,a as q,b as U,c as P}from"./card-DHszHnbI.js";import{S as I,a as L,b as O,c as R,d as j}from"./select-BEhl2QER.js";import{A as V}from"./app-BBiA4mAE.js";import{u as $}from"./useTranslation-CV4_gBnb.js";import{M as G}from"./mail-XtzF_PXw.js";import{S as J}from"./save-B89BgUdM.js";import{E as K}from"./eye-off-ub0Xog94.js";import{E as Q}from"./eye-C8Kok_ez.js";import{S as z}from"./send-J2b8i-sO.js";import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./chevron-down-Zr-tNTku.js";import"./createLucideIcon-Dov4NOxw.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";/* empty css            */const B=s=>({provider:(s==null?void 0:s.email_provider)||"smtp",driver:(s==null?void 0:s.email_driver)||"smtp",host:(s==null?void 0:s.email_host)||"smtp.example.com",port:(s==null?void 0:s.email_port)||"587",username:(s==null?void 0:s.email_username)||"user@example.com",password:(s==null?void 0:s.email_password)||"",encryption:(s==null?void 0:s.email_encryption)||"tls",fromAddress:(s==null?void 0:s.email_fromAddress)||"noreply@example.com"});function ye({userSettings:s,auth:f,emailProviders:v={}}){var T,F;const{t:r}=$(),[b,C]=c.useState(!1),l=(F=(T=f==null?void 0:f.user)==null?void 0:T.permissions)==null?void 0:F.includes("edit-email-settings"),[i,u]=c.useState(()=>B(s)),[N,D]=c.useState(!1),[h,H]=c.useState(""),[E,w]=c.useState(!1),[g,p]=c.useState(null);c.useEffect(()=>{s&&u(B(s))},[s]);const m=(a,o)=>{if(a==="provider"&&v[o]){const d=v[o];u(x=>({...x,provider:o,driver:d.driver,host:d.host,port:d.port,encryption:d.encryption}))}else u(d=>({...d,[a]:o}))},S=()=>{C(!0);const a={...i};V.post(route("settings.email.update"),{settings:a},{preserveScroll:!0,onSuccess:()=>{},onError:()=>{},onFinish:()=>{C(!1)}})},k=a=>{a.preventDefault(),!(!h||!l)&&(w(!0),p(null),V.post(route("settings.email.test"),{email:h},{preserveScroll:!0,onSuccess:o=>{var M,A;const d=(M=o.props.flash)==null?void 0:M.success,x=(A=o.props.flash)==null?void 0:A.error;d?p({success:!0,message:d}):x&&p({success:!1,message:x}),setTimeout(()=>p(null),5e3)},onError:o=>{const d=o.error||Object.values(o).join(", ")||r("Failed to send test email");p({success:!1,message:d}),setTimeout(()=>p(null),5e3)},onFinish:()=>{w(!1)}}))};return e.jsxs(_,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"order-1 rtl:order-2",children:[e.jsxs(U,{className:"flex items-center gap-2 text-lg",children:[e.jsx(G,{className:"h-5 w-5"}),r("Email Settings")]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r("Configure email server settings for system notifications and communications")})]}),l&&e.jsxs(y,{className:"order-2 rtl:order-1",onClick:S,disabled:b,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),r(b?"Saving...":"Save Changes")]})]}),e.jsx(P,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"provider",className:"font-medium",children:r("Email Provider")}),e.jsxs(I,{value:i.provider,onValueChange:a=>{m("provider",a),m("driver",a)},disabled:!l,children:[e.jsx(L,{children:e.jsx(O,{placeholder:"Select provider"})}),e.jsx(R,{children:Object.entries(v).map(([a,o])=>e.jsx(j,{value:a,children:o.name},a))})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"driver",className:"font-medium",children:r("Mail Driver")}),e.jsx(n,{id:"driver",value:i.driver,onChange:a=>m("driver",a.target.value),disabled:!l,placeholder:"smtp"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"host",className:"font-medium",children:r("SMTP Host")}),e.jsx(n,{id:"host",value:i.host,onChange:a=>m("host",a.target.value),disabled:!l,placeholder:"smtp.example.com"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"port",className:"font-medium",children:r("SMTP Port")}),e.jsx(n,{id:"port",value:i.port,onChange:a=>m("port",a.target.value),disabled:!l,placeholder:"587"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"username",className:"font-medium",children:r("SMTP Username")}),e.jsx(n,{id:"username",value:i.username,onChange:a=>m("username",a.target.value),disabled:!l,placeholder:"user@example.com"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"password",className:"font-medium",children:r("SMTP Password")}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{id:"password",type:N?"text":"password",value:i.password,onChange:a=>m("password",a.target.value),disabled:!l,placeholder:"••••••••••••",className:"pr-10"}),l&&e.jsx(y,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>D(!N),children:N?e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"})})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"encryption",className:"font-medium",children:r("Mail Encryption")}),e.jsxs(I,{value:i.encryption,onValueChange:a=>m("encryption",a),disabled:!l,children:[e.jsx(L,{children:e.jsx(O,{placeholder:"Select encryption"})}),e.jsxs(R,{children:[e.jsx(j,{value:"tls",children:r("TLS")}),e.jsx(j,{value:"ssl",children:r("SSL")}),e.jsx(j,{value:"none",children:r("None")})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"fromAddress",className:"font-medium",children:r("From Address")}),e.jsx(n,{id:"fromAddress",value:i.fromAddress,onChange:a=>m("fromAddress",a.target.value),disabled:!l,placeholder:"noreply@example.com"})]})]})})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(_,{children:e.jsx(P,{className:"pt-6",children:e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(z,{className:"h-4 w-4 text-primary"}),e.jsx("h3",{className:"text-base font-medium",children:r("Test Email Configuration")})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{htmlFor:"testEmail",className:"font-medium",children:r("Send Test To")}),e.jsx(n,{id:"testEmail",type:"email",value:h,onChange:a=>H(a.target.value),placeholder:"test@example.com",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r("Enter an email address to send a test message")})]}),g&&e.jsx("div",{className:`p-3 rounded-md text-sm ${g.success?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:g.message}),e.jsx(y,{type:"submit",className:"w-full",disabled:E||!h||!l,children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"◌"}),r("Sending...")]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),r("Send Test Email")]})})]})})})})]})})]})}export{ye as default};
