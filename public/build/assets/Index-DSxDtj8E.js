import{j as e}from"./ui-ZHFf5B17.js";import{r as y}from"./vendor-CcMVubkO.js";import{X as Pe,A as S,S as Fe}from"./app-BBiA4mAE.js";import{u as Me}from"./useFlashMessages-3JrX8KdK.js";import{u as Ve}from"./useDeleteHandler-BcjiOXkX.js";import{A as Ee,D as Ke,a as Le,b as Oe,c as $}from"./authenticated-layout-CIIwr118.js";import{B as N}from"./button-DYC7yMVq.js";import{C as ze,c as V}from"./card-DHszHnbI.js";import{D as Ie}from"./data-table--afTq2As.js";import{D as ce}from"./dialog-BLwxprq_.js";import{C as Ge}from"./confirmation-dialog-mYyCtWPl.js";import{T as q,a as c,b as p,c as u}from"./tooltip-C7wT1CW2.js";import{F as Re}from"./filter-button-DAh-SSEg.js";import{P as $e}from"./pagination-B-_jt0WF.js";import{S as qe}from"./search-input-BmfsW7ME.js";import{P as He}from"./per-page-selector-CH0Bh0qB.js";import{S as H,a as U,b as W,c as J,d as T}from"./select-BEhl2QER.js";import{B as Ue}from"./badge-CV60sqBJ.js";import{K as We}from"./kanban-board-DJ4GF6Aa.js";import Je from"./Create-DQhOFvaJ.js";import Xe from"./Edit-CfNEJyPJ.js";import Qe from"./LabelView-CdSZyoeO.js";import{N as Ye}from"./no-records-found-C2RGIdAh.js";import{f as pe,j as Ze}from"./helpers-QYnGjXad.js";import{u as E}from"./usePageButtons-Dl7ivmUg.js";import{u as es}from"./useTranslation-CV4_gBnb.js";import{E as ue}from"./eye-C8Kok_ez.js";import{T as ss}from"./tag-B8n-xlTS.js";import{S as xe}from"./square-pen-D0WnMiRU.js";import{T as he}from"./trash-2-CIuynBL1.js";import{D as ge}from"./dollar-sign-CaNGv6yE.js";import{L as ts}from"./list-BVwWsOhE.js";import{p as rs,e as is}from"./lucide-react-DCPJy5XZ.js";import{P as as}from"./plus-C1hmRCnY.js";import{S as os}from"./square-check-big-jIi-JzLQ.js";import{S as ls}from"./shopping-cart-Dh9vxMBK.js";import{G as ns}from"./globe-CbUyzYsc.js";/* empty css            */import"./input-DqOfVTcn.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./label-DbqhUtKI.js";import"./index-BMyiKApA.js";import"./refresh-cw-DjdBLqaG.js";import"./createLucideIcon-Dov4NOxw.js";import"./language-lyE4jnGJ.js";import"./settings-BQeqI1zG.js";import"./separator-DVB3ZNtW.js";import"./x-DVK_F_Gh.js";import"./panel-left-BJWtIBes.js";import"./chevron-right-BtPraxo3.js";import"./check-DUlQPeVG.js";import"./circle-bmoNtd-e.js";import"./chevron-down-Zr-tNTku.js";import"./calculator-T0kIVMoE.js";import"./calendar-DvmJ2XsD.js";import"./code-zYLA2qp9.js";import"./target-DdsyVirL.js";import"./panels-top-left-jTb_Yuv7.js";import"./trending-up-DP6snsap.js";import"./layers-DwAcD_sb.js";import"./file-check-Y_ulrqs4.js";import"./users-OzPx1l-a.js";import"./headphones-BkxDRJ_v.js";import"./clock-3RA97mBy.js";import"./video-NvD8FrU_.js";import"./credit-card-CditegsP.js";import"./mail-XtzF_PXw.js";import"./image-C8M1mNs8.js";import"./package-rNDE_pCr.js";import"./message-circle-TeiA59tv.js";import"./use-favicon-CGM0zyjT.js";import"./search-Chs14P_a.js";import"./avatar-BOBGUcwF.js";import"./index-DaFL_H0m.js";import"./sun-BFQeGX5r.js";import"./moon-CVX3oKK_.js";import"./monitor-CEyd7Aqp.js";import"./cookie-consent-OcwKHqiv.js";import"./switch-ByWYyd_6.js";import"./index-BYFX2qNQ.js";import"./cookie-DkEMAjDp.js";import"./user-x-DrMYVmY_.js";import"./table-DHznIK9t.js";import"./chevron-left-CMBAh2v_.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BZAHB8Ku.js";import"./index-BdQq_4o_.js";import"./input-error-DuIbBMgZ.js";import"./currency-input-BZrT8lhz.js";import"./phone-input-d5yugTbF.js";import"./multi-select-enhanced-C0hF2-Yw.js";import"./popover-fYI5j510.js";import"./useFormFields-BwNmEYJY.js";import"./textarea-DxQ_BnuT.js";import"./radio-group-Bg6nc_Xb.js";import"./slider-CIevYFX0.js";import"./sparkles-yKnt-shd.js";import"./index-Chjiymov.js";import"./index-8JwjhRSi.js";import"./rich-text-editor-59agrfWF.js";import"./with-selector-CP8JaRn2.js";import"./undo-D3tFEvb3.js";import"./link-2Bt5o4zZ.js";import"./checkbox-Cvtgzug2.js";import"./activity-DJdfPCaa.js";import"./arrow-left-vDNMjIRy.js";import"./arrow-right-left-B2Yy1Hqs.js";import"./arrow-right-0NYEyiZu.js";import"./award-DEt0AONC.js";import"./bar-chart-3-BYjotveo.js";import"./ticket-CPT2TfbK.js";import"./briefcase-CLMrDjdn.js";import"./bug-DBRM7-K0.js";import"./building-2-DdQko_34.js";import"./building-BGlxQx6H.js";import"./circle-alert-De6bM8Qi.js";import"./circle-check-big-CGCa8M7E.js";import"./circle-check-D2gG32Ng.js";import"./circle-help-CE56Mn6R.js";import"./circle-user-BD0wePLr.js";import"./clipboard-check-DGMK1yDo.js";import"./copy-BfAQhGce.js";import"./database-D2i84R0z.js";import"./download-DpWzK9fg.js";import"./external-link-DAKK0PZS.js";import"./eye-off-ub0Xog94.js";import"./youtube-ChBQIMoB.js";import"./server-CDiKS8E7.js";import"./file-image-pr_SxnfH.js";import"./mouse-pointer-CQQJQqrL.js";import"./file-question-CR2qrXfg.js";import"./file-text-BmYvzZ5U.js";import"./file-BD5h_kEE.js";import"./folder-open-DRNg9mxz.js";import"./grid-3x3-BHB0xGDK.js";import"./grip-vertical-DvbJAfYs.js";import"./hard-drive-7HjIbMwJ.js";import"./hash-C8mMST2K.js";import"./home-lZzXcexX.js";import"./info-CuYUIdBA.js";import"./lightbulb-C1h491_-.js";import"./loader-circle-Dxyp6AS6.js";import"./map-pin-BtfG8ici.js";import"./megaphone-iO7AZhEi.js";import"./menu-CO-7TdWM.js";import"./message-square-warning-CPUQBKZG.js";import"./message-square-U01x5Y17.js";import"./milestone-BpY-7UvC.js";import"./minus-B1ExV4rD.js";import"./music-CaAUDMgx.js";import"./octagon-alert-_2iLUPIm.js";import"./palette-DZNd6Hfk.js";import"./paperclip-C_mZqrNn.js";import"./pen-tool-CqsLxcXF.js";import"./ruler-IeLgeA9Q.js";import"./phone-B_vxbsBq.js";import"./play-D1oIUpjL.js";import"./printer-BDwaclJ1.js";import"./radio-XBYO3AW-.js";import"./rotate-ccw-C3yG9Vnv.js";import"./save-B89BgUdM.js";import"./send-J2b8i-sO.js";import"./shield-alert-DzGJ4C70.js";import"./shield-DylwwFFg.js";import"./star-D9yXa3BZ.js";import"./sticky-note-C2BipOAH.js";import"./timer-B_1PmEWX.js";import"./trending-down-L1xdWaEg.js";import"./triangle-alert-Ad-nVD4c.js";import"./type-J3x5O6X0.js";import"./upload-KhHqnUys.js";import"./user-check-BJVxGvgh.js";import"./user-DQm7Eg7s.js";import"./zap-DKIHv8g2.js";function ki(){var se,te,re,ie,ae,oe,le,ne,de,me;const{t:r}=es(),{deals:w,auth:x,pipelines:v,stages:h,groups:ds,users:ms,sources:K,products:L,permissions:cs}=Pe().props,g=new URLSearchParams(window.location.search),[i,C]=y.useState({name:g.get("name")||"",notes:g.get("notes")||"",pipeline_id:g.get("pipeline_id")||((te=(se=v==null?void 0:v[0])==null?void 0:se.id)==null?void 0:te.toString())||"",stage_id:g.get("stage_id")||"",status:g.get("status")||"",is_active:g.get("is_active")||""}),[_]=y.useState(g.get("per_page")||"10"),[P,je]=y.useState(g.get("sort")||""),[F,fe]=y.useState(g.get("direction")||"asc"),[j,ve]=y.useState(g.get("view")||"list"),[k,X]=y.useState({isOpen:!1,mode:"",data:null}),[ps,us]=y.useState(null),[O,z]=y.useState(null),[I,be]=y.useState(!1);Me();const{deleteState:Q,openDeleteDialog:Y,closeDeleteDialog:ye,confirmDelete:Se}=Ve({routeName:"lead.deals.destroy",defaultMessage:r("Are you sure you want to delete this deal?")}),Z=()=>{S.get(route("lead.deals.index"),{...i,per_page:_,sort:P,direction:F,view:j},{preserveState:!0,replace:!0})},Ne=t=>{const s=P===t&&F==="asc"?"desc":"asc";je(t),fe(s),S.get(route("lead.deals.index"),{...i,per_page:_,sort:t,direction:s,view:j},{preserveState:!0,replace:!0})},we=E("googleDriveBtn",{module:"Deal",settingKey:"GoogleDrive Deal"}),De=E("oneDriveBtn",{module:"Deal",settingKey:"OneDrive Deal"}),Ce=E("dropboxBtn",{module:"Deal",settingKey:"Dropbox Deal"}),_e=E("hubspotBtn",{module:"Deal",settingKey:"HubSpot Deal"}),ee=()=>{C({name:"",notes:"",pipeline_id:"",stage_id:"",status:"",is_active:""}),S.get(route("lead.deals.index"),{per_page:_,view:j})},M=(t,s=null)=>{X({isOpen:!0,mode:t,data:s})},G=()=>{X({isOpen:!1,mode:"",data:null})},ke=(t,s,n)=>{S.post(route("lead.deals.order"),{deal_id:t,stage_id:n,order:[t]},{preserveState:!0,onSuccess:()=>{S.reload({only:["deals"]})}})},Ae=()=>{var f;const t=["#3b82f6","#ef4444","#10b77f","#f59e0b","#8b5cf6","#06b6d4","#f97316","#84cc16","#ec4899","#6366f1"],n=(i.pipeline_id&&i.pipeline_id!==""?(h==null?void 0:h.filter(a=>{var l;return((l=a.pipeline_id)==null?void 0:l.toString())===i.pipeline_id}))||[]:h||[]).map((a,l)=>({id:a.id.toString(),title:a.name,color:t[l%t.length]})),d={};return n.forEach(a=>{d[a.id]=[]}),(((f=w==null?void 0:w.data)==null?void 0:f.filter(a=>{var m;let l=!0;return i.pipeline_id&&i.pipeline_id!==""&&(l=l&&((m=a.pipeline_id)==null?void 0:m.toString())===i.pipeline_id),l}))||[]).forEach(a=>{var m;const l=(m=a.stage_id)==null?void 0:m.toString();l&&d[l]&&d[l].push({id:a.id,title:a.name,description:a.phone,status:l,due_date:null,assigned_to:a.user_deals||[],priority:null,deal:a})}),{columns:n,tasks:d}},Be=({task:t})=>{var d,b,f,a,l,m,A;const s=t.deal,n=o=>{o.dataTransfer.setData("application/json",JSON.stringify({taskId:t.id,fromStatus:t.status})),o.dataTransfer.effectAllowed="move"};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 mb-2 hover:shadow-md transition-all cursor-move select-none group",draggable:!0,onDragStart:n,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 leading-tight pr-2 cursor-pointer hover:text-primary hover:underline",onClick:o=>{o.stopPropagation(),S.get(route("lead.deals.show",s.id))},children:t.title}),e.jsxs(Ke,{children:[e.jsx(Le,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 opacity-0 group-hover:opacity-100",children:e.jsx(is,{className:"h-3 w-3"})})}),e.jsxs(Oe,{align:"end",children:[((b=(d=x.user)==null?void 0:d.permissions)==null?void 0:b.includes("view-deals"))&&e.jsxs($,{onClick:()=>S.get(route("lead.deals.show",s.id)),children:[e.jsx(ue,{className:"h-3 w-3 mr-2"}),r("View")]}),((a=(f=x.user)==null?void 0:f.permissions)==null?void 0:a.includes("edit-deals"))&&e.jsxs($,{onClick:()=>M("edit",s),children:[e.jsx(xe,{className:"h-3 w-3 mr-2"}),r("Edit")]}),((m=(l=x.user)==null?void 0:l.permissions)==null?void 0:m.includes("delete-deals"))&&e.jsxs($,{onClick:()=>Y(s.id),className:"text-red-600",children:[e.jsx(he,{className:"h-3 w-3 mr-2"}),r("Delete")]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs(c,{children:[e.jsx(p,{children:e.jsxs("div",{className:`flex items-center space-x-1 text-sm font-medium px-2 py-1 rounded ${s.tasks_count>0&&s.complete_tasks_count===s.tasks_count?"text-green-600 bg-green-50":"text-gray-600 bg-gray-50"}`,children:[e.jsx(os,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.complete_tasks_count||0,"/",s.tasks_count||0]})]})}),e.jsx(u,{children:e.jsx("p",{children:r("Tasks")})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(c,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-blue-600 font-medium bg-blue-50 px-2 py-1 rounded",children:[e.jsx(ls,{className:"h-3 w-3"}),e.jsx("span",{children:s.products?Array.isArray(s.products)?s.products.length:s.products.split(",").filter(Boolean).length:0})]})}),e.jsx(u,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r("Products")}),s.products&&(Array.isArray(s.products)?s.products:s.products.split(",")).filter(Boolean).length>0?(Array.isArray(s.products)?s.products:s.products.split(",")).filter(Boolean).map((o,B)=>{const D=L==null?void 0:L.find(R=>R.id.toString()===String(o).trim());return e.jsx("p",{className:"text-sm",children:(D==null?void 0:D.name)||`Product ${o}`},B)}):""]})})]}),e.jsxs(c,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-purple-600 font-medium bg-purple-50 px-2 py-1 rounded",children:[e.jsx(ns,{className:"h-3 w-3"}),e.jsx("span",{children:s.sources?Array.isArray(s.sources)?s.sources.length:s.sources.split(",").filter(Boolean).length:0})]})}),e.jsx(u,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r("Sources")}),s.sources&&(Array.isArray(s.sources)?s.sources:s.sources.split(",")).filter(Boolean).length>0?(Array.isArray(s.sources)?s.sources:s.sources.split(",")).filter(Boolean).map((o,B)=>{const D=K==null?void 0:K.find(R=>R.id.toString()===String(o).trim());return e.jsx("p",{className:"text-sm",children:(D==null?void 0:D.name)||`Source ${o}`},B)}):""]})})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex -space-x-2",children:e.jsxs(q,{children:[!s.users||s.users.length===0?e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 border-2 border-background flex items-center justify-center text-sm font-medium",children:"-"}):s.users.slice(0,3).map((o,B)=>e.jsxs(c,{children:[e.jsx(p,{children:e.jsx("div",{className:"h-8 w-8 rounded-full border-2 border-background overflow-hidden",children:o.avatar?e.jsx("img",{src:Ze(o.avatar),alt:o.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-primary/10 flex items-center justify-center text-sm font-medium",children:o.name.charAt(0).toUpperCase()})})}),e.jsx(u,{children:e.jsx("p",{children:o.name})})]},o.id)),((A=s.users)==null?void 0:A.length)>3&&e.jsxs(c,{children:[e.jsx(p,{children:e.jsxs("div",{className:"h-8 w-8 rounded-full bg-gray-100 border-2 border-background flex items-center justify-center text-xs font-medium",children:["+",s.users.length-3]})}),e.jsx(u,{children:e.jsx("div",{className:"space-y-1",children:s.users.slice(3).map((o,B)=>e.jsx("p",{children:o.name},o.id))})})]})]})}),s.price&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-green-600 font-medium",children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{children:pe(s.price)})]})]})]})},Te=[{key:"name",header:r("Name"),sortable:!0},{key:"price",header:r("Price"),sortable:!1,render:t=>t?pe(t):"-"},{key:"pipeline.name",header:r("Pipeline Name"),sortable:!1,render:(t,s)=>{var n;return((n=s.pipeline)==null?void 0:n.name)||"-"}},{key:"stage",header:r("Stage"),sortable:!1,render:(t,s)=>{var d,b;const n=((d=s.stage)==null?void 0:d.name)||((b=h==null?void 0:h.find(f=>{var a;return f.id.toString()===((a=s.stage_id)==null?void 0:a.toString())}))==null?void 0:b.name);return e.jsx(Ue,{variant:"secondary",children:n||"No Stage"})}},{key:"tasks",header:r("Tasks"),sortable:!1,render:(t,s)=>{const n=s.tasks_count||0,d=s.complete_tasks_count||0;return e.jsxs("span",{className:`text-sm font-medium ${n===0?"text-gray-400":d===n?"text-green-600":""}`,children:[d,"/",n]})}},...(ie=(re=x.user)==null?void 0:re.permissions)!=null&&ie.some(t=>["view-deals","edit-deals","delete-deals"].includes(t))?[{key:"actions",header:r("Actions"),render:(t,s)=>{var n,d,b,f,a,l,m,A;return e.jsx("div",{className:"flex gap-1",children:e.jsxs(q,{children:[((d=(n=x.user)==null?void 0:n.permissions)==null?void 0:d.includes("view-deals"))&&e.jsxs(c,{delayDuration:0,children:[e.jsx(p,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>S.get(route("lead.deals.show",s.id)),className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:r("View")})})]}),((f=(b=x.user)==null?void 0:b.permissions)==null?void 0:f.includes("edit-deals"))&&e.jsxs(c,{delayDuration:0,children:[e.jsx(p,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>z(s),className:"h-8 w-8 p-0 text-purple-600 hover:text-purple-700",children:e.jsx(ss,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:r("Label")})})]}),((l=(a=x.user)==null?void 0:a.permissions)==null?void 0:l.includes("edit-deals"))&&e.jsxs(c,{delayDuration:0,children:[e.jsx(p,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>M("edit",s),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:r("Edit")})})]}),((A=(m=x.user)==null?void 0:m.permissions)==null?void 0:A.includes("delete-deals"))&&e.jsxs(c,{delayDuration:0,children:[e.jsx(p,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>Y(s.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:r("Delete")})})]})]})})}}]:[]];return e.jsxs(Ee,{breadcrumbs:[{label:r("CRM"),url:route("lead.index")},{label:r("Deals")}],pageTitle:r("Manage Deals"),pageActions:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(q,{children:[e.jsxs(H,{value:i.pipeline_id||((oe=(ae=v==null?void 0:v[0])==null?void 0:ae.id)==null?void 0:oe.toString())||"all",onValueChange:t=>{const s=t==="all"?"":t;C({...i,pipeline_id:s}),S.get(route("lead.deals.index"),{...i,pipeline_id:s,per_page:_,sort:P,direction:F,view:j},{preserveState:!0,replace:!0})},children:[e.jsx(U,{className:"w-40",children:e.jsx(W,{placeholder:r("Select Pipeline")})}),e.jsx(J,{children:v==null?void 0:v.map(t=>e.jsx(T,{value:t.id.toString(),children:t.name},t.id))})]}),we.map(t=>e.jsx("div",{children:t.component},t.id)),De.map(t=>e.jsx("div",{children:t.component},t.id)),Ce.map(t=>e.jsx("div",{children:t.component},t.id)),_e.map(t=>e.jsx("div",{children:t.component},t.id)),((ne=(le=x.user)==null?void 0:le.permissions)==null?void 0:ne.includes("view-deals"))&&e.jsx(e.Fragment,{children:e.jsxs(c,{delayDuration:0,children:[e.jsx(p,{asChild:!0,children:e.jsx(N,{size:"sm",onClick:()=>ve(j==="kanban"?"list":"kanban"),children:j==="kanban"?e.jsx(ts,{className:"h-4 w-4"}):e.jsx(rs,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:r(j==="kanban"?"List View":"Kanban View")})})]})}),((me=(de=x.user)==null?void 0:de.permissions)==null?void 0:me.includes("create-deals"))&&e.jsxs(c,{delayDuration:0,children:[e.jsx(p,{asChild:!0,children:e.jsx(N,{size:"sm",onClick:()=>M("add"),children:e.jsx(as,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:r("Create")})})]})]})}),children:[e.jsx(Fe,{title:r("Deals")}),j==="kanban"?(()=>{const{columns:t,tasks:s}=Ae();return e.jsx(We,{tasks:s,columns:t,onMove:ke,taskCard:Be,kanbanActions:null})})():e.jsxs(ze,{className:"shadow-sm",children:[e.jsx(V,{className:"p-6 border-b bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(qe,{value:i.name,onChange:t=>C({...i,name:t}),onSearch:Z,placeholder:r("Search Deals...")})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(He,{routeName:"lead.deals.index",filters:{...i,view:j}}),e.jsxs("div",{className:"relative",children:[e.jsx(Re,{showFilters:I,onToggle:()=>be(!I)}),(()=>{const t=[i.stage_id,i.status].filter(s=>s!==""&&s!==null&&s!==void 0).length;return t>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-primary text-primary-foreground text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:t})})()]})]})]})}),I&&e.jsx(V,{className:"p-6 bg-blue-50/30 border-b",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("Stage")}),e.jsxs(H,{value:i.stage_id,onValueChange:t=>C({...i,stage_id:t}),children:[e.jsx(U,{children:e.jsx(W,{placeholder:r("Filter by Stage")})}),e.jsx(J,{children:h==null?void 0:h.map(t=>e.jsx(T,{value:t.id.toString(),children:t.name},t.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("Status")}),e.jsxs(H,{value:i.status,onValueChange:t=>C({...i,status:t}),children:[e.jsx(U,{children:e.jsx(W,{placeholder:r("Filter by Status")})}),e.jsxs(J,{children:[e.jsx(T,{value:"Won",children:r("Won")}),e.jsx(T,{value:"Loss",children:r("Loss")}),e.jsx(T,{value:"Active",children:r("Active")})]})]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(N,{onClick:Z,size:"sm",children:r("Apply")}),e.jsx(N,{variant:"outline",onClick:ee,size:"sm",children:r("Clear")})]})]})}),e.jsx(V,{className:"p-0",children:e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[70vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[800px]",children:e.jsx(Ie,{data:(w==null?void 0:w.data)||[],columns:Te,onSort:Ne,sortKey:P,sortDirection:F,className:"rounded-none",emptyState:e.jsx(Ye,{icon:ge,title:r("No Deals found"),description:r("Get started by creating your first Deal."),hasFilters:!!(i.name||i.notes||i.pipeline_id||i.stage_id||i.status||i.is_active),onClearFilters:ee,createPermission:"create-deals",onCreateClick:()=>M("add"),createButtonText:r("Create Deal"),className:"h-auto"})})})})}),e.jsx(V,{className:"px-4 py-2 border-t bg-gray-50/30",children:e.jsx($e,{data:w||{data:[],links:[],meta:{}},routeName:"lead.deals.index",filters:{...i,per_page:_,view:j}})})]}),e.jsxs(ce,{open:k.isOpen,onOpenChange:G,children:[k.mode==="add"&&e.jsx(Je,{onSuccess:G}),k.mode==="edit"&&k.data&&e.jsx(Xe,{deal:k.data,onSuccess:G})]}),e.jsx(ce,{open:!!O,onOpenChange:()=>z(null),children:O&&e.jsx(Qe,{deal:O,onSuccess:()=>z(null)})}),e.jsx(Ge,{open:Q.isOpen,onOpenChange:ye,title:r("Delete Deal"),message:Q.message,confirmText:r("Delete"),onConfirm:Se,variant:"destructive"})]})}export{ki as default};
