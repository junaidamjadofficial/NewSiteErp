import{j as e}from"./ui-ZHFf5B17.js";import{r as a}from"./vendor-CcMVubkO.js";import{X as k,a as w}from"./app-BBiA4mAE.js";import{B as c}from"./button-DYC7yMVq.js";import{C as E,c as u}from"./card-DHszHnbI.js";import{D as y}from"./date-picker-CVthJV3y.js";import{a as N,f as n}from"./helpers-QYnGjXad.js";import{N as F}from"./no-records-found-C2RGIdAh.js";import{u as S}from"./useTranslation-CV4_gBnb.js";import{P as T}from"./printer-BDwaclJ1.js";import{F as P}from"./file-text-BmYvzZ5U.js";/* empty css            */import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";import"./react-datepicker-BHcKmBHW.js";import"./popover-fYI5j510.js";import"./calendar-DvmJ2XsD.js";import"./createLucideIcon-Dov4NOxw.js";import"./plus-C1hmRCnY.js";function Y({financialYear:s}){var g,j;const{t}=S(),{auth:f}=k().props,[l,x]=a.useState((s==null?void 0:s.year_start_date)||""),[m,p]=a.useState((s==null?void 0:s.year_end_date)||""),[o,_]=a.useState(null),[i,h]=a.useState(!1),b=async()=>{h(!0);try{const r=await w.get(route("double-entry.reports.expense-report"),{params:{from_date:l,to_date:m}});_(r.data)}catch(r){console.error("Error fetching expense report:",r)}finally{h(!1)}};a.useEffect(()=>{b()},[]);const v=()=>{const r=route("double-entry.reports.expense-report.print")+`?from_date=${l}&to_date=${m}&download=pdf`;window.open(r,"_blank")},D=()=>{x((s==null?void 0:s.year_start_date)||""),p((s==null?void 0:s.year_end_date)||"")},C=r=>!o||o.total_expenses===0?0:(r/o.total_expenses*100).toFixed(1);return e.jsxs(E,{className:"shadow-sm",children:[e.jsx(u,{className:"p-6 border-b bg-gray-50/50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("From Date")}),e.jsx(y,{value:l,onChange:x,placeholder:t("Select from date")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("To Date")}),e.jsx(y,{value:m,onChange:p,placeholder:t("Select to date")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Â "}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(c,{onClick:b,disabled:i,size:"sm",children:t(i?"Loading...":"Generate")}),e.jsx(c,{variant:"outline",onClick:D,size:"sm",children:t("Clear")}),o&&((j=(g=f.user)==null?void 0:g.permissions)==null?void 0:j.includes("print-expense-report"))&&e.jsxs(c,{variant:"outline",size:"sm",onClick:v,className:"gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),t("Download PDF")]})]})]})]})}),e.jsx(u,{className:"p-0",children:o&&o.expenses.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t("Expense Report by Category")}),e.jsxs("p",{className:"text-sm text-gray-600",children:[N(o.from_date)," ",t("to")," ",N(o.to_date)]}),e.jsxs("p",{className:"text-sm font-semibold mt-2",children:[t("Total Expenses"),": ",n(o.total_expenses)]})]}),e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[60vh] w-full",children:e.jsx("div",{className:"min-w-[700px]",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:t("Rank")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:t("Account Code")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:t("Expense Category")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:t("Amount")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:t("% of Total")})]})}),e.jsxs("tbody",{children:[o.expenses.map((r,d)=>e.jsxs("tr",{className:`border-t hover:bg-gray-50 ${d<5?"bg-blue-50/30":""}`,children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:d+1}),e.jsx("td",{className:"px-4 py-3 text-sm",children:r.account_code}),e.jsx("td",{className:"px-4 py-3 text-sm",children:r.account_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold",children:n(r.amount)}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right",children:[C(r.amount),"%"]})]},d)),e.jsxs("tr",{className:"bg-gray-200 font-bold border-t-4 border-gray-800 sticky bottom-0",children:[e.jsx("td",{colSpan:3,className:"px-4 py-4 text-base",children:t("Total Expenses")}),e.jsx("td",{className:"px-4 py-4 text-base text-right",children:n(o.total_expenses)}),e.jsx("td",{className:"px-4 py-4 text-base text-right",children:"100%"})]})]})]})})})]}):e.jsx(F,{icon:P,title:t("Expense Report"),description:t("Select date range to generate the report"),className:"h-auto py-12"})})]})}export{Y as default};
