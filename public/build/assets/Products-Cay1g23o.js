import{j as e}from"./ui-ZHFf5B17.js";import{r as a}from"./vendor-CcMVubkO.js";import{A as x}from"./app-BBiA4mAE.js";import{D as b}from"./data-table--afTq2As.js";import{B as d}from"./button-DYC7yMVq.js";import{D as T,a as A,b as k,c as w}from"./dialog-BLwxprq_.js";import{L as O}from"./label-DbqhUtKI.js";import{M as E}from"./multi-select-enhanced-C0hF2-Yw.js";import{T as M,a as B,b as I,c as F}from"./tooltip-C7wT1CW2.js";import{C as L}from"./confirmation-dialog-mYyCtWPl.js";import{N as _}from"./no-records-found-C2RGIdAh.js";import{u as $}from"./useTranslation-CV4_gBnb.js";import{P as z}from"./package-rNDE_pCr.js";import{T as G}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./input-DqOfVTcn.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./popover-fYI5j510.js";import"./badge-CV60sqBJ.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./index-BZAHB8Ku.js";import"./plus-C1hmRCnY.js";function Se({deal:s,availableProducts:i,onRegisterAddHandler:m}){a.useEffect(()=>{m(()=>h())},[m]);const{t:o}=$(),[g,n]=a.useState(!1),[j,P]=a.useState([]),[c,p]=a.useState([]),[v,D]=a.useState({}),[l,u]=a.useState({isOpen:!1,productId:null,message:""}),S=()=>{P(i.map(t=>({value:t.id.toString(),label:t.name})))},y=()=>{c.length!==0&&x.post(route("lead.deals.assign-products",s.id),{product_ids:c.map(t=>parseInt(t))},{onSuccess:()=>{n(!1),p([])}})},h=()=>{S(),n(!0)},N=t=>{u({isOpen:!0,productId:t,message:o("Are you sure you want to delete this product?")})},f=()=>{u({isOpen:!1,productId:null,message:""})},C=()=>{l.productId&&(x.delete(route("lead.deals.remove-product",{deal:s.id,product:l.productId})),f())};return a.useEffect(()=>{if(s.products&&i.length>0){const t={};i.forEach(r=>{t[r.id]=r.name}),D(t)}},[s.products,i]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(b,{data:s.products?[...new Set((Array.isArray(s.products)?s.products:s.products.split(",")).filter(Boolean).map(t=>t.toString().trim()))].map((t,r)=>({id:t,key:`product-${t}-${r}`,name:v[t]||""})):[],columns:[{key:"name",header:o("Product Name"),render:(t,r)=>r.name||"-"},{key:"actions",header:o("Action"),render:(t,r)=>e.jsx("div",{className:"flex gap-1",children:e.jsx(M,{children:e.jsxs(B,{delayDuration:0,children:[e.jsx(I,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{N(r.id)},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsx(F,{children:e.jsx("p",{children:o("Delete Product")})})]})})})}],className:"rounded-none",emptyState:e.jsx(_,{icon:z,title:o("No Products added"),description:o("Get started by adding products to this deal."),onCreateClick:()=>h(),createButtonText:o("Add Products"),className:"h-auto"})})})}),e.jsx(T,{open:g,onOpenChange:n,children:e.jsxs(A,{className:"max-w-md",children:[e.jsx(k,{children:e.jsx(w,{children:o("Add Products")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(O,{children:o("Select Products")}),e.jsx(E,{options:j,value:c,onValueChange:p,placeholder:o("Select products"),searchable:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>n(!1),children:o("Cancel")}),e.jsx(d,{onClick:y,disabled:c.length===0,children:o("Save")})]})]})]})}),e.jsx(L,{open:l.isOpen,onOpenChange:f,title:o("Delete Product"),message:l.message,confirmText:o("Delete"),onConfirm:C,variant:"destructive"})]})}export{Se as default};
