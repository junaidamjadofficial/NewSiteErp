import{j as t}from"./ui-ZHFf5B17.js";import{r as c}from"./vendor-CcMVubkO.js";import{X as I,a as v}from"./app-BBiA4mAE.js";import{B as u}from"./button-DYC7yMVq.js";import{C as R,c as j}from"./card-DHszHnbI.js";import{S as $,a as L,b as V,c as G,d as O}from"./select-BEhl2QER.js";import{D as C}from"./date-picker-CVthJV3y.js";import{a as g,f as l}from"./helpers-QYnGjXad.js";import{N as w}from"./no-records-found-C2RGIdAh.js";import{u as U}from"./useTranslation-CV4_gBnb.js";import{P as X}from"./printer-BDwaclJ1.js";import{F as A}from"./file-text-BmYvzZ5U.js";/* empty css            */import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./input-DqOfVTcn.js";import"./chevron-down-Zr-tNTku.js";import"./createLucideIcon-Dov4NOxw.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./react-datepicker-BHcKmBHW.js";import"./popover-fYI5j510.js";import"./calendar-DvmJ2XsD.js";import"./plus-C1hmRCnY.js";function yt({financialYear:o}){var _,D;const{t:s}=U(),{auth:k}=I().props,[d,i]=c.useState(""),[n,b]=c.useState((o==null?void 0:o.year_start_date)||""),[m,y]=c.useState((o==null?void 0:o.year_end_date)||""),[F,N]=c.useState([]),[a,x]=c.useState(null),[p,h]=c.useState(null),[f,S]=c.useState(!1),P=async()=>{if(d){S(!0);try{const e=await v.get(route("double-entry.reports.account-statement"),{params:{account_id:d,from_date:n,to_date:m}});x(e.data.data),N(e.data.accounts),h(e.data.selectedAccount)}catch(e){console.error("Error fetching account statement:",e)}finally{S(!1)}}};c.useEffect(()=>{(async()=>{try{const r=await v.get(route("double-entry.reports.account-statement"));N(r.data.accounts),r.data.data&&x(r.data.data),r.data.selectedAccount&&(i(r.data.selectedAccount.id.toString()),h(r.data.selectedAccount))}catch(r){console.error("Error loading data:",r)}})()},[]);const T=()=>{const e=route("double-entry.reports.account-statement.print")+`?account_id=${d}&from_date=${n}&to_date=${m}&download=pdf`;window.open(e,"_blank")},B=()=>{i(""),b((o==null?void 0:o.year_start_date)||""),y((o==null?void 0:o.year_end_date)||""),x(null),h(null)},E=(a==null?void 0:a.transactions.reduce((e,r)=>e+r.debit,0))||0,z=(a==null?void 0:a.transactions.reduce((e,r)=>e+r.credit,0))||0;return t.jsxs(R,{className:"shadow-sm",children:[t.jsx(j,{className:"p-6 border-b bg-gray-50/50",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("Account")}),t.jsxs($,{value:d,onValueChange:i,children:[t.jsx(L,{children:t.jsx(V,{placeholder:s("Select Account")})}),t.jsx(G,{searchable:!0,children:F.map(e=>t.jsxs(O,{value:e.id.toString(),children:[e.account_code," - ",e.account_name]},e.id))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("From Date")}),t.jsx(C,{value:n,onChange:b,placeholder:s("Select from date")})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("To Date")}),t.jsx(C,{value:m,onChange:y,placeholder:s("Select to date")})]}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx(u,{onClick:P,disabled:!d||f,size:"sm",children:s(f?"Loading...":"Generate")}),t.jsx(u,{variant:"outline",onClick:B,size:"sm",children:s("Clear")}),a&&((D=(_=k.user)==null?void 0:_.permissions)==null?void 0:D.includes("print-account-statement"))&&t.jsxs(u,{variant:"outline",size:"sm",onClick:T,className:"gap-2",children:[t.jsx(X,{className:"h-4 w-4"}),s("Download PDF")]})]})]})}),a?t.jsxs(j,{className:"p-0",children:[p&&t.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[t.jsxs("h3",{className:"font-semibold text-lg",children:[p.account_code," - ",p.account_name]}),n&&m&&t.jsxs("p",{className:"text-sm text-gray-600",children:[s("Statement Period"),": ",g(n)," ",s("to")," ",g(m)]})]}),t.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[60vh] w-full",children:t.jsx("div",{className:"min-w-[900px]",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-100 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:s("Date")}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:s("Description")}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:s("Reference")}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:s("Debit")}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:s("Credit")}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:s("Balance")})]})}),t.jsxs("tbody",{children:[a.opening_balance!==0&&t.jsxs("tr",{className:"bg-blue-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold",colSpan:5,children:s("Opening Balance")}),t.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold",children:l(a.opening_balance)})]}),a.transactions.length>0?a.transactions.map(e=>t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm",children:g(e.date)}),t.jsx("td",{className:"px-4 py-3 text-sm",children:e.description}),t.jsx("td",{className:"px-4 py-3 text-sm",children:e.reference_type}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:e.debit>0?l(e.debit):"-"}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:e.credit>0?l(e.credit):"-"}),t.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium",children:l(e.balance)})]},e.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"px-4 py-8",children:t.jsx(w,{icon:A,title:s("No transactions found"),description:s("No transactions found for the selected account and date range."),className:"h-auto"})})}),a.transactions.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("tr",{className:"bg-gray-50 border-t-2",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold",colSpan:3,children:s("Total")}),t.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold",children:l(E)}),t.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold",children:l(z)}),t.jsx("td",{className:"px-4 py-3 text-sm"})]}),t.jsxs("tr",{className:"bg-gray-100 font-semibold sticky bottom-0",children:[t.jsx("td",{className:"px-4 py-3 text-sm",colSpan:5,children:s("Closing Balance")}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:l(a.closing_balance)})]})]})]})]})})})]}):t.jsx(j,{className:"p-0",children:t.jsx(w,{icon:A,title:s("Account Statement"),description:s("Select an account and date range to generate the statement"),className:"h-auto py-12"})})]})}export{yt as default};
