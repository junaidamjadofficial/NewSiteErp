import{j as s}from"./ui-ZHFf5B17.js";import{r as j}from"./vendor-CcMVubkO.js";import{X as N,S as g}from"./app-BBiA4mAE.js";import{a as v}from"./html2pdf-Dais6JZR.js";import{b as t,a as u,f as r}from"./helpers-QYnGjXad.js";import{u as _}from"./useTranslation-CV4_gBnb.js";/* empty css            */function E(){var d,o,m,x;const{t:e}=_(),{proposal:n}=N().props,[b,c]=j.useState(!1);j.useEffect(()=>{new URLSearchParams(window.location.search).get("download")==="pdf"&&f()},[]);const f=async()=>{c(!0);const a=document.querySelector(".proposal-container");if(a){const l={margin:.25,filename:`sales-proposal-${n.proposal_number}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};try{await v().set(l).from(a).save(),setTimeout(()=>window.close(),1e3)}catch(i){console.error("PDF generation failed:",i)}}c(!1)};return s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx(g,{title:e("Sales Proposal")}),b&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),s.jsx("p",{className:"text-lg font-semibold text-gray-700",children:e("Generating PDF...")})]})})}),s.jsxs("div",{className:"proposal-container bg-white max-w-4xl mx-auto p-8",children:[s.jsxs("div",{className:"flex justify-between items-start mb-8",children:[s.jsxs("div",{className:"w-1/2",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:t("company_name")||"YOUR COMPANY"}),s.jsxs("div",{className:"text-sm space-y-1",children:[t("company_address")&&s.jsx("p",{children:t("company_address")}),(t("company_city")||t("company_state")||t("company_zipcode"))&&s.jsxs("p",{children:[t("company_city"),t("company_state")&&`, ${t("company_state")}`," ",t("company_zipcode")]}),t("company_country")&&s.jsx("p",{children:t("company_country")}),t("company_telephone")&&s.jsxs("p",{children:[e("Phone"),": ",t("company_telephone")]}),t("company_email")&&s.jsxs("p",{children:[e("Email"),": ",t("company_email")]}),t("registration_number")&&s.jsxs("p",{children:[e("Registration"),": ",t("registration_number")]})]})]}),s.jsxs("div",{className:"text-right w-1/2",children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:e("SALES PROPOSAL")}),s.jsxs("p",{className:"text-lg font-semibold",children:["#",n.proposal_number]}),s.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[s.jsxs("p",{children:[e("Date"),": ",u(n.proposal_date)]}),s.jsxs("p",{children:[e("Due"),": ",u(n.due_date)]})]})]})]}),s.jsxs("div",{className:"flex justify-between mb-8",children:[s.jsxs("div",{className:"w-1/2",children:[s.jsx("h3",{className:"font-bold mb-3",children:e("PROPOSAL TO")}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsx("p",{className:"font-semibold",children:(d=n.customer)==null?void 0:d.name}),s.jsx("p",{children:(o=n.customer)==null?void 0:o.email})]})]}),s.jsxs("div",{className:"text-right w-1/2",children:[s.jsx("h3",{className:"font-bold mb-3",children:e("WAREHOUSE")}),s.jsx("div",{className:"text-sm space-y-1",children:s.jsx("p",{children:((m=n.warehouse)==null?void 0:m.name)||"-"})})]})]}),s.jsx("div",{className:"mb-8",children:s.jsxs("table",{className:"w-full table-fixed",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-300",children:[s.jsx("th",{className:"text-left py-3 font-bold",children:e("ITEM")}),s.jsx("th",{className:"text-center py-3 font-bold",children:e("QTY")}),s.jsx("th",{className:"text-right py-3 font-bold",children:e("PRICE")}),s.jsx("th",{className:"text-right py-3 font-bold",children:e("DISCOUNT")}),s.jsx("th",{className:"text-right py-3 font-bold",children:e("TAX")}),s.jsx("th",{className:"text-right py-3 font-bold",children:e("TOTAL")})]})}),s.jsx("tbody",{children:(x=n.items)==null?void 0:x.map((a,l)=>{var i,p;return s.jsxs("tr",{className:"page-break-inside-avoid",children:[s.jsxs("td",{className:"py-4",children:[s.jsx("div",{className:"font-semibold",children:(i=a.product)==null?void 0:i.name}),((p=a.product)==null?void 0:p.sku)&&s.jsxs("div",{className:"text-xs text-gray-500",children:[e("SKU"),": ",a.product.sku]})]}),s.jsx("td",{className:"text-center py-4",children:a.quantity}),s.jsx("td",{className:"text-right py-4",children:r(a.unit_price)}),s.jsx("td",{className:"text-right py-4",children:a.discount_percentage>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-sm",children:[a.discount_percentage,"%"]}),s.jsxs("div",{className:"text-sm font-medium",children:["-",r(a.discount_amount)]})]}):s.jsx("div",{className:"text-sm",children:"0%"})}),s.jsx("td",{className:"text-right py-4",children:a.taxes&&a.taxes.length>0?s.jsxs(s.Fragment,{children:[a.taxes.map((h,y)=>s.jsxs("div",{className:"text-sm",children:[h.tax_name," (",h.tax_rate,"%)"]},y)),s.jsx("div",{className:"text-sm font-medium",children:r(a.tax_amount)})]}):a.tax_percentage>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-sm",children:[a.tax_percentage,"%"]}),s.jsx("div",{className:"text-sm font-medium",children:r(a.tax_amount)})]}):s.jsx("div",{className:"text-sm",children:"0%"})}),s.jsx("td",{className:"text-right py-4 font-semibold",children:r(a.total_amount)})]},l)})})]})}),s.jsx("div",{className:"flex justify-end mb-4 page-break-inside-avoid",children:s.jsx("div",{className:"w-80 page-break-inside-avoid",children:s.jsx("div",{className:"border border-gray-400 p-4 page-break-inside-avoid",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e("Subtotal"),":"]}),s.jsx("span",{children:r(n.subtotal)})]}),n.discount_amount>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e("Discount"),":"]}),s.jsxs("span",{children:["-",r(n.discount_amount)]})]}),n.tax_amount>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e("Tax"),":"]}),s.jsx("span",{children:r(n.tax_amount)})]}),s.jsx("div",{className:"border-t border-gray-400 pt-2 mt-2",children:s.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[s.jsxs("span",{children:[e("TOTAL"),":"]}),s.jsx("span",{children:r(n.total_amount)})]})})]})})})}),s.jsxs("div",{className:"border-t border-gray-400 pt-4 text-center",children:[s.jsxs("p",{className:"font-semibold",children:[e("PAYMENT TERMS"),": ",n.payment_terms||e("Net 30 Days")]}),s.jsx("p",{className:"text-sm mt-2",children:e("Thank you for your business!")})]})]}),s.jsx("style",{children:`
                body {
                    -webkit-print-color-adjust: exact;
                    color-adjust: exact;
                    font-family: Arial, sans-serif;
                }

                @page {
                    margin: 0.5in;
                    size: A4;
                }

                .proposal-container {
                    max-width: 100%;
                    margin: 0;
                    box-shadow: none;
                }

                .page-break-inside-avoid {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }

                @media print {
                    body {
                        background: white;
                    }

                    .proposal-container {
                        box-shadow: none;
                    }
                }
            `})]})}export{E as default};
