import{j as e}from"./ui-ZHFf5B17.js";import{r}from"./vendor-CcMVubkO.js";import{A as j}from"./app-BBiA4mAE.js";import{D as A}from"./data-table--afTq2As.js";import{B as m}from"./button-DYC7yMVq.js";import{D as w,a as k,b as O,c as I}from"./dialog-BLwxprq_.js";import{L as M}from"./label-DbqhUtKI.js";import{M as _}from"./multi-select-enhanced-C0hF2-Yw.js";import{T as E,a as B,b as R,c as U}from"./tooltip-C7wT1CW2.js";import{C as F}from"./confirmation-dialog-mYyCtWPl.js";import{N as L}from"./no-records-found-C2RGIdAh.js";import{j as P}from"./helpers-QYnGjXad.js";import{u as z}from"./useTranslation-CV4_gBnb.js";import{U as G}from"./users-OzPx1l-a.js";import{T as V}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./input-DqOfVTcn.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./popover-fYI5j510.js";import"./badge-CV60sqBJ.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./index-BZAHB8Ku.js";import"./plus-C1hmRCnY.js";function Se({deal:i,availableClients:v,onRegisterAddHandler:d}){r.useEffect(()=>{d(()=>h())},[d]);const{t}=z(),[g,n]=r.useState(!1),[b,y]=r.useState([]),[o,p]=r.useState([]),[c,u]=r.useState({isOpen:!1,clientId:null,message:""}),D=()=>{y(v.map(a=>({value:a.id.toString(),label:a.name})))},N=()=>{o.length!==0&&j.post(route("lead.deals.assign-clients",i.id),{client_ids:o.map(a=>parseInt(a))},{onSuccess:()=>{n(!1),p([])}})},h=()=>{D(),n(!0)},S=a=>{u({isOpen:!0,clientId:a,message:t("Are you sure you want to remove this client?")})},f=()=>{u({isOpen:!1,clientId:null,message:""})},T=()=>{c.clientId&&(j.delete(route("lead.deals.remove-client",{deal:i.id,client:c.clientId})),f())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(A,{data:i.client_deals?Array.isArray(i.client_deals)?i.client_deals:[]:[],columns:[{key:"client.avatar",header:t("Avatar"),render:(a,l)=>{var x,C;const s=l.client;return e.jsx("div",{className:"h-8 w-8 rounded-full border-2 border-background overflow-hidden",children:s!=null&&s.avatar?e.jsx("img",{src:P(s.avatar),alt:s.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-primary/10 flex items-center justify-center text-sm font-medium",children:((C=(x=s==null?void 0:s.name)==null?void 0:x.charAt(0))==null?void 0:C.toUpperCase())||"C"})})}},{key:"client.name",header:t("Client Name"),render:(a,l)=>{var s;return((s=l.client)==null?void 0:s.name)||"-"}},{key:"actions",header:t("Action"),render:(a,l)=>e.jsx("div",{className:"flex gap-1",children:e.jsx(E,{children:e.jsxs(B,{delayDuration:0,children:[e.jsx(R,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>{var s;S((s=l.client)==null?void 0:s.id)},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(V,{className:"h-4 w-4"})})}),e.jsx(U,{children:e.jsx("p",{children:t("Delete Client")})})]})})})}],className:"rounded-none",emptyState:e.jsx(L,{icon:G,title:t("No Clients added"),description:t("Get started by adding clients to this deal."),onCreateClick:()=>h(),createButtonText:t("Add Clients"),className:"h-auto"})})})}),e.jsx(w,{open:g,onOpenChange:n,children:e.jsxs(k,{className:"max-w-md",children:[e.jsx(O,{children:e.jsx(I,{children:t("Add Clients")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{children:t("Select Clients")}),e.jsx(_,{options:b,value:o,onValueChange:p,placeholder:t("Select clients"),searchable:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>n(!1),children:t("Cancel")}),e.jsx(m,{onClick:N,disabled:o.length===0,children:t("Save")})]})]})]})}),e.jsx(F,{open:c.isOpen,onOpenChange:f,title:t("Remove Client"),message:c.message,confirmText:t("Remove"),onConfirm:T,variant:"destructive"})]})}export{Se as default};
