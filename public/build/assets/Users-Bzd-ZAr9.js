import{j as e}from"./ui-ZHFf5B17.js";import{r as o}from"./vendor-CcMVubkO.js";import{A as v}from"./app-BBiA4mAE.js";import{D as T}from"./data-table--afTq2As.js";import{B as d}from"./button-DYC7yMVq.js";import{D as w,a as A,b as k,c as O}from"./dialog-BLwxprq_.js";import{L as I}from"./label-DbqhUtKI.js";import{M}from"./multi-select-enhanced-C0hF2-Yw.js";import{T as E,a as B,b as R,c as _}from"./tooltip-C7wT1CW2.js";import{C as F}from"./confirmation-dialog-mYyCtWPl.js";import{N as L}from"./no-records-found-C2RGIdAh.js";import{j as P}from"./helpers-QYnGjXad.js";import{u as z}from"./useTranslation-CV4_gBnb.js";import{U as G}from"./users-OzPx1l-a.js";import{T as V}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./input-DqOfVTcn.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./popover-fYI5j510.js";import"./badge-CV60sqBJ.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./index-BZAHB8Ku.js";import"./plus-C1hmRCnY.js";function Ce({deal:m,availableUsers:g,onRegisterAddHandler:c}){o.useEffect(()=>{c(()=>h())},[c]);const{t:s}=z(),[U,i]=o.useState(!1),[b,D]=o.useState([]),[l,p]=o.useState([]),[n,u]=o.useState({isOpen:!1,userId:null,message:""}),N=()=>{D(g.map(t=>({value:t.id.toString(),label:t.name})))},y=()=>{l.length!==0&&v.post(route("lead.deals.assign-users",m.id),{user_ids:l.map(t=>parseInt(t))},{onSuccess:()=>{i(!1),p([])}})},h=()=>{N(),i(!0)},C=t=>{u({isOpen:!0,userId:t,message:s("Are you sure you want to remove this user?")})},f=()=>{u({isOpen:!1,userId:null,message:""})},S=()=>{n.userId&&(v.delete(route("lead.deals.remove-user",{deal:m.id,user:n.userId})),f())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(T,{data:m.user_deals||[],columns:[{key:"user.avatar",header:s("Avatar"),render:(t,a)=>{var x,j;const r=a.user;return e.jsx("div",{className:"h-8 w-8 rounded-full border-2 border-background overflow-hidden",children:r!=null&&r.avatar?e.jsx("img",{src:P(r.avatar),alt:r.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-primary/10 flex items-center justify-center text-sm font-medium",children:((j=(x=r==null?void 0:r.name)==null?void 0:x.charAt(0))==null?void 0:j.toUpperCase())||"U"})})}},{key:"user.name",header:s("User Name"),render:(t,a)=>{var r;return((r=a.user)==null?void 0:r.name)||"-"}},{key:"actions",header:s("Action"),render:(t,a)=>e.jsx("div",{className:"flex gap-1",children:e.jsx(E,{children:e.jsxs(B,{delayDuration:0,children:[e.jsx(R,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{var r;C((r=a.user)==null?void 0:r.id)},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(V,{className:"h-4 w-4"})})}),e.jsx(_,{children:e.jsx("p",{children:s("Delete User")})})]})})})}],className:"rounded-none",emptyState:e.jsx(L,{icon:G,title:s("No Users added"),description:s("Get started by adding users to this deal."),onCreateClick:()=>h(),createButtonText:s("Add Users"),className:"h-auto"})})})}),e.jsx(w,{open:U,onOpenChange:i,children:e.jsxs(A,{className:"max-w-md",children:[e.jsx(k,{children:e.jsx(O,{children:s("Add Users")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:s("Select Users")}),e.jsx(M,{options:b,value:l,onValueChange:p,placeholder:s("Select users"),searchable:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>i(!1),children:s("Cancel")}),e.jsx(d,{onClick:y,disabled:l.length===0,children:s("Save")})]})]})]})}),e.jsx(F,{open:n.isOpen,onOpenChange:f,title:s("Remove User"),message:n.message,confirmText:s("Remove"),onConfirm:S,variant:"destructive"})]})}export{Ce as default};
