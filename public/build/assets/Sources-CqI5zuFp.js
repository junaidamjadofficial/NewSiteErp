import{j as e}from"./ui-ZHFf5B17.js";import{r as a}from"./vendor-CcMVubkO.js";import{A as j}from"./app-BBiA4mAE.js";import{D as k}from"./data-table--afTq2As.js";import{B as m}from"./button-DYC7yMVq.js";import{D as A,a as O,b as E,c as M}from"./dialog-BLwxprq_.js";import{L as B}from"./label-DbqhUtKI.js";import{M as I}from"./multi-select-enhanced-C0hF2-Yw.js";import{T as F,a as L,b as _,c as $}from"./tooltip-C7wT1CW2.js";import{C as z}from"./confirmation-dialog-mYyCtWPl.js";import{N as G}from"./no-records-found-C2RGIdAh.js";import{u as P}from"./useTranslation-CV4_gBnb.js";import{D as R}from"./database-D2i84R0z.js";import{T as V}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./input-DqOfVTcn.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./popover-fYI5j510.js";import"./badge-CV60sqBJ.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./index-BZAHB8Ku.js";import"./plus-C1hmRCnY.js";function Ne({lead:r,onRegisterAddHandler:u}){a.useEffect(()=>{u(()=>h())},[u]);const{t:s}=P(),[g,i]=a.useState(!1),[v,D]=a.useState([]),[c,d]=a.useState([]),[b,y]=a.useState({}),[n,p]=a.useState({isOpen:!1,sourceId:null,message:""}),N=async()=>{try{const t=await(await fetch(route("lead.leads.available-sources",r.id))).json();D(t.map(l=>({value:l.id.toString(),label:l.name})))}catch{}},C=()=>{c.length!==0&&j.post(route("lead.leads.assign-sources",r.id),{source_ids:c.map(o=>parseInt(o))},{onSuccess:()=>{i(!1),d([])}})},h=()=>{N(),i(!0)},T=o=>{p({isOpen:!0,sourceId:o,message:s("Are you sure you want to delete this source?")})},f=()=>{p({isOpen:!1,sourceId:null,message:""})},w=()=>{n.sourceId&&(j.delete(route("lead.leads.remove-source",{lead:r.id,source:n.sourceId})),f())};return a.useEffect(()=>{(async()=>{if(r.sources)try{const l=await(await fetch(route("lead.leads.available-sources",r.id))).json(),S={};l.forEach(x=>{S[x.id]=x.name}),y(S)}catch{}})()},[r.sources]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(k,{data:r.sources?[...new Set(r.sources.split(",").filter(Boolean).map(o=>o.trim()))].map((o,t)=>({id:o,key:`source-${o}-${t}`,name:b[o]||""})):[],columns:[{key:"name",header:s("Source Name"),render:(o,t)=>t.name||""},{key:"actions",header:s("Action"),render:(o,t)=>e.jsx("div",{className:"flex gap-1",children:e.jsx(F,{children:e.jsxs(L,{delayDuration:0,children:[e.jsx(_,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>{T(t.id)},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(V,{className:"h-4 w-4"})})}),e.jsx($,{children:e.jsx("p",{children:s("Delete Source")})})]})})})}],className:"rounded-none",emptyState:e.jsx(G,{icon:R,title:s("No Sources added"),description:s("Get started by adding sources to this lead."),onCreateClick:()=>h(),createButtonText:s("Add Sources"),className:"h-auto"})})})}),e.jsx(A,{open:g,onOpenChange:i,children:e.jsxs(O,{className:"max-w-md",children:[e.jsx(E,{children:e.jsx(M,{children:s("Add Sources")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:s("Select Sources")}),e.jsx(I,{options:v,value:c,onValueChange:d,placeholder:s("Select sources"),searchable:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>i(!1),children:s("Cancel")}),e.jsx(m,{onClick:C,disabled:c.length===0,children:s("Save")})]})]})]})}),e.jsx(z,{open:n.isOpen,onOpenChange:f,title:s("Delete Source"),message:n.message,confirmText:s("Delete"),onConfirm:w,variant:"destructive"})]})}export{Ne as default};
