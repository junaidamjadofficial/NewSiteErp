import{j as e}from"./ui-ZHFf5B17.js";import{r as m}from"./vendor-CcMVubkO.js";import{S as L,a as N,c as S,d as x}from"./select-BEhl2QER.js";import{t as u,X as y,A as b}from"./app-BBiA4mAE.js";import{D as F,a as D,b as E,c as P}from"./dialog-BLwxprq_.js";import{B as v}from"./button-DYC7yMVq.js";import{I as f}from"./input-DqOfVTcn.js";import{L as j}from"./label-DbqhUtKI.js";import{u as w}from"./useTranslation-CV4_gBnb.js";import{R as T}from"./refresh-cw-DjdBLqaG.js";import{l as k}from"./language-lyE4jnGJ.js";import{G as A}from"./globe-CbUyzYsc.js";import{P as M}from"./plus-C1hmRCnY.js";import{S as R}from"./settings-BQeqI1zG.js";function q({open:a,onOpenChange:c,onSuccess:o}){const{t:s}=w(),[t,l]=m.useState({code:"",name:"",countryCode:""}),[i,h]=m.useState(!1),p=async n=>{var g;n.preventDefault(),h(!0);try{const d=await fetch(route("languages.create"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"))||""},body:JSON.stringify(t)}),r=await d.json();d.ok?(u.success(s("Language created successfully")),l({code:"",name:"",countryCode:""}),c(!1),o==null||o(),window.location.reload()):u.error(r.error||s("Failed to create language"))}catch{u.error(s("Failed to create language"))}finally{h(!1)}};return e.jsx(F,{open:a,onOpenChange:c,children:e.jsxs(D,{className:"sm:max-w-md",children:[e.jsx(E,{children:e.jsx(P,{children:s("Create Language")})}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"code",children:s("Language Code")}),e.jsx(f,{id:"code",placeholder:s("e.g., fr, de, ja"),value:t.code,onChange:n=>l({...t,code:n.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:s("Language Name")}),e.jsx(f,{id:"name",placeholder:s("e.g., Français, Deutsch, 日本語"),value:t.name,onChange:n=>l({...t,name:n.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"countryCode",children:s("Country Code")}),e.jsx(f,{id:"countryCode",placeholder:s("e.g., FR, DE, JP"),maxLength:2,value:t.countryCode,onChange:n=>l({...t,countryCode:n.target.value.toUpperCase()}),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>c(!1),children:s("Cancel")}),e.jsx(v,{type:"submit",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4 animate-spin mr-2"}),s("Creating...")]}):s("Create Language")})]})]})]})})}const I=a=>{const c=a.toUpperCase().split("").map(o=>127397+o.charCodeAt(0));return String.fromCodePoint(...c)},C=k.filter(a=>a.enabled!==!1).map(a=>({...a,flag:I(a.countryCode)}));function Z(){var g,d;const{i18n:a,t:c}=w(),{auth:o}=y().props,[s,t]=m.useState(a.language||"en"),[l,i]=m.useState(!1),h=(d=(g=o==null?void 0:o.user)==null?void 0:g.roles)==null?void 0:d.some(r=>r.name==="superadmin"||r==="superadmin");m.useEffect(()=>{t(a.language||"en")},[a.language]);const p=r=>{if(r==="manage_languages"){b.get(route("languages.manage"),{lang:s});return}if(r==="create_language"){i(!0);return}t(r),a.changeLanguage(r)},n=C.find(r=>r.code===s)||C[0];return e.jsxs(e.Fragment,{children:[e.jsxs(L,{value:s,onValueChange:p,children:[e.jsx(N,{className:"w-auto border dark:border-slate-700 shadow-sm bg-white dark:bg-slate-800 hover:bg-muted/50 [&>svg]:hidden",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:n.name}),e.jsx("span",{className:"text-sm",children:n.flag})]})}),e.jsxs(S,{align:"end",className:"max-h-48 overflow-y-auto",children:[C.map(r=>e.jsx(x,{value:r.code,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:r.flag}),e.jsx("span",{children:r.name})]})},r.code)),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t my-1"}),e.jsx(x,{value:"create_language",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{children:c("Create Language")})]})}),e.jsx(x,{value:"manage_languages",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{children:c("Manage Languages")})]})})]})]})]}),e.jsx(q,{open:l,onOpenChange:i,onSuccess:()=>i(!1)})]})}const $=()=>{const{flash:a}=y().props;m.useEffect(()=>{a!=null&&a.success&&u.success(a.success),a!=null&&a.error&&u.error(a.error),a!=null&&a.warning&&u.warning(a.warning)},[a])};export{Z as L,$ as u};
