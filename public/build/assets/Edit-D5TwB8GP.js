import{j as e}from"./ui-ZHFf5B17.js";import{a as X,b as $,c as z}from"./dialog-BLwxprq_.js";import{X as J,G as Q}from"./app-BBiA4mAE.js";import{B as V}from"./button-DYC7yMVq.js";import{L as c}from"./label-DbqhUtKI.js";import{I as l}from"./input-error-DuIbBMgZ.js";import{I as g}from"./input-DqOfVTcn.js";import{S as v,a as f,b as S,c as b,d as y}from"./select-BEhl2QER.js";import{P as W}from"./phone-input-d5yugTbF.js";import{D as Y}from"./date-picker-CVthJV3y.js";import{R as Z}from"./rich-text-editor-59agrfWF.js";import{M as w}from"./multi-select-enhanced-C0hF2-Yw.js";import{r as d}from"./vendor-CcMVubkO.js";import{a as ee}from"./helpers-QYnGjXad.js";import{u as _}from"./useFormFields-BwNmEYJY.js";import{u as se}from"./useTranslation-CV4_gBnb.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./x-DVK_F_Gh.js";import"./createLucideIcon-Dov4NOxw.js";/* empty css            */import"./index-BMyiKApA.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./chevron-down-Zr-tNTku.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./react-datepicker-BHcKmBHW.js";import"./popover-fYI5j510.js";import"./calendar-DvmJ2XsD.js";import"./index-DaFL_H0m.js";import"./with-selector-CP8JaRn2.js";import"./undo-D3tFEvb3.js";import"./list-BVwWsOhE.js";import"./link-2Bt5o4zZ.js";import"./badge-CV60sqBJ.js";import"./tooltip-C7wT1CW2.js";import"./textarea-DxQ_BnuT.js";import"./radio-group-Bg6nc_Xb.js";import"./circle-bmoNtd-e.js";import"./slider-CIevYFX0.js";import"./sparkles-yKnt-shd.js";import"./switch-ByWYyd_6.js";import"./index-Chjiymov.js";import"./index-8JwjhRSi.js";function Je({lead:t,sources:p,products:m,onSuccess:N}){var C,F,D,I,P,U;const{users:h,pipelines:j,products:te}=J().props,[x,A]=d.useState([]),[L,O]=d.useState(p||[]),[T,R]=d.useState(m||[]),{t:i}=se(),{data:r,setData:o,put:k,processing:E,errors:a}=Q({subject:t.subject??"",user_id:((C=t.user_id)==null?void 0:C.toString())||"",name:t.name??"",email:t.email??"",phone:t.phone??"",date:t.date||"",pipeline_id:((F=t.pipeline_id)==null?void 0:F.toString())||"",stage_id:((D=t.stage_id)==null?void 0:D.toString())||"",sources:Array.isArray(t.sources)?t.sources:t.sources?t.sources.split(","):[],products:Array.isArray(t.products)?t.products:t.products?t.products.split(","):[],notes:t.notes??""}),q=_("aiField",r,o,a,"edit","name","Name","lead","lead"),B=_("aiField",r,o,a,"edit","subject","Subject","lead","lead"),[K,M]=d.useState(0),G=_("aiField",r,(s,n)=>{o(s,n),M(u=>u+1)},a,"edit","notes","Notes","lead","lead");d.useEffect(()=>{var s,n,u;t&&o({subject:t.subject??"",user_id:((s=t.user_id)==null?void 0:s.toString())||"",name:t.name??"",email:t.email??"",phone:t.phone??"",date:t.date||"",pipeline_id:((n=t.pipeline_id)==null?void 0:n.toString())||"",stage_id:((u=t.stage_id)==null?void 0:u.toString())||"",sources:Array.isArray(t.sources)?t.sources:t.sources?t.sources.split(","):[],products:Array.isArray(t.products)?t.products:t.products?t.products.split(","):[],notes:t.notes??""})},[t]),d.useEffect(()=>{p&&O(p),m&&R(m)},[p,m]),d.useEffect(()=>{r.pipeline_id&&fetch(route("lead.stages.by-pipeline",r.pipeline_id)).then(s=>s.json()).then(s=>A(s)).catch(()=>A([]))},[r.pipeline_id]);const H=s=>{s.preventDefault();const n={...r,sources:Array.isArray(r.sources)?r.sources.length>0?r.sources.join(","):"":r.sources,products:Array.isArray(r.products)?r.products.length>0?r.products.join(","):"":r.products};k(route("lead.leads.update",t.id),{data:n,onSuccess:()=>{N()}})};return e.jsxs(X,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx($,{children:e.jsx(z,{children:i("Edit Lead")})}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(c,{htmlFor:"name",children:i("Name")}),e.jsx(g,{id:"name",type:"text",value:r.name,onChange:s=>o("name",s.target.value),placeholder:i("Enter Name"),required:!0}),e.jsx(l,{message:a.name})]}),q.map(s=>e.jsx("div",{children:s.component},s.id))]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"email",children:i("Email")}),e.jsx(g,{id:"email",type:"email",value:r.email,onChange:s=>o("email",s.target.value),placeholder:i("Enter Email")}),e.jsx(l,{message:a.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(c,{htmlFor:"subject",children:i("Subject")}),e.jsx(g,{id:"subject",type:"text",value:r.subject,onChange:s=>o("subject",s.target.value),placeholder:i("Enter Subject"),required:!0}),e.jsx(l,{message:a.subject})]}),B.map(s=>e.jsx("div",{children:s.component},s.id))]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"user_id",children:i("User")}),e.jsxs(v,{value:((I=r.user_id)==null?void 0:I.toString())||"",onValueChange:s=>o("user_id",s),children:[e.jsx(f,{children:e.jsx(S,{placeholder:i("Select User")})}),e.jsx(b,{children:h==null?void 0:h.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]}),e.jsx(l,{message:a.user_id})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(W,{label:i("Phone No"),value:r.phone,onChange:s=>o("phone",s||""),error:a.phone})}),e.jsxs("div",{children:[e.jsx(c,{children:i("Follow Up Date")}),e.jsx(Y,{value:r.date,onChange:s=>o("date",ee(s)),placeholder:i("Select Follow Up Date")}),e.jsx(l,{message:a.date})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"pipeline_id",children:i("Pipeline")}),e.jsxs(v,{value:((P=r.pipeline_id)==null?void 0:P.toString())||"",onValueChange:s=>o("pipeline_id",s),children:[e.jsx(f,{children:e.jsx(S,{placeholder:i("Select Pipeline")})}),e.jsx(b,{children:j==null?void 0:j.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]}),e.jsx(l,{message:a.pipeline_id})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"stage_id",children:i("Stage")}),e.jsxs(v,{value:((U=r.stage_id)==null?void 0:U.toString())||"",onValueChange:s=>o("stage_id",s),children:[e.jsx(f,{children:e.jsx(S,{placeholder:i("Select Stage")})}),e.jsx(b,{children:x==null?void 0:x.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]}),e.jsx(l,{message:a.stage_id})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"sources",children:i("Sources")}),e.jsx(w,{options:Object.entries(L).map(([s,n])=>({value:s,label:n})),value:Array.isArray(r.sources)?r.sources:[],onValueChange:s=>o("sources",s),placeholder:i("Select Sources"),searchable:!0}),e.jsx(l,{message:a.sources})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"products",children:i("Products")}),e.jsx(w,{options:Object.entries(T).map(([s,n])=>({value:s,label:n})),value:Array.isArray(r.products)?r.products:[],onValueChange:s=>o("products",s),placeholder:i("Select Products"),searchable:!0}),e.jsx(l,{message:a.products})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(c,{htmlFor:"notes",children:i("Notes")}),e.jsx("div",{className:"flex gap-2",children:G.map(s=>e.jsx("div",{children:s.component},s.id))})]}),e.jsx(Z,{content:r.notes||"",onChange:s=>o("notes",s),placeholder:i("Enter Notes")},`notes-editor-${K}`),e.jsx(l,{message:a.notes})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(V,{type:"button",variant:"outline",onClick:N,children:i("Cancel")}),e.jsx(V,{type:"submit",disabled:E,children:i(E?"Updating...":"Update")})]})]})]})}export{Je as default};
