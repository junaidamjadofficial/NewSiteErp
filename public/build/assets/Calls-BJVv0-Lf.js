import{j as e}from"./ui-ZHFf5B17.js";import{r as n}from"./vendor-CcMVubkO.js";import{A as h}from"./app-BBiA4mAE.js";import{D as P}from"./data-table--afTq2As.js";import{B as u}from"./button-DYC7yMVq.js";import{D as R,a as q,b as V,c as z}from"./dialog-BLwxprq_.js";import{S,a as D,b as _,c as T,d as x}from"./select-BEhl2QER.js";import{L as o}from"./label-DbqhUtKI.js";import{I as N}from"./input-DqOfVTcn.js";import{T as L}from"./textarea-DxQ_BnuT.js";import{R as M}from"./rich-text-editor-59agrfWF.js";import{B as G}from"./badge-CV60sqBJ.js";import{T as U,a as O,b as w,c as E}from"./tooltip-C7wT1CW2.js";import{C as $}from"./confirmation-dialog-mYyCtWPl.js";import{N as H}from"./no-records-found-C2RGIdAh.js";import{m as J}from"./helpers-QYnGjXad.js";import{u as K}from"./useTranslation-CV4_gBnb.js";import{P as Q}from"./phone-B_vxbsBq.js";import{S as W}from"./square-pen-D0WnMiRU.js";import{T as X}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./index-DaFL_H0m.js";import"./with-selector-CP8JaRn2.js";import"./undo-D3tFEvb3.js";import"./list-BVwWsOhE.js";import"./link-2Bt5o4zZ.js";import"./plus-C1hmRCnY.js";function Me({deal:m,onRegisterAddHandler:j}){var C;n.useEffect(()=>{j(()=>i(!0))},[j]);const{t:s}=K(),[k,i]=n.useState(!1),[c,p]=n.useState(null),[l,r]=n.useState({subject:"",call_type:"Outbound",duration:"",assignee:"",description:"",call_result:""}),[d,g]=n.useState({isOpen:!1,callId:null,message:""}),F=t=>{t.preventDefault(),c?h.put(route("deal.calls.update",c.id),l,{onSuccess:()=>{r({subject:"",call_type:"Outbound",duration:"",assignee:"",description:"",call_result:""}),i(!1),p(null)}}):h.post(route("deal.calls.store"),{deal_id:m.id,...l},{onSuccess:()=>{r({subject:"",call_type:"Outbound",duration:"",assignee:"",description:"",call_result:""}),i(!1)}})},I=t=>{var a;p(t),r({subject:t.subject||"",call_type:t.call_type||"Outbound",duration:t.duration||"",assignee:((a=t.user_id)==null?void 0:a.toString())||"",description:t.description||"",call_result:t.call_result||""}),i(!0)},B=t=>{g({isOpen:!0,callId:t,message:s("Are you sure you want to delete this call?")})},f=()=>{g({isOpen:!1,callId:null,message:""})},A=()=>{d.callId&&(h.delete(route("deal.calls.destroy",d.callId)),f())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(P,{data:m.calls||[],columns:[{key:"subject",header:s("Subject")},{key:"call_type",header:s("Call Type"),render:t=>e.jsx(G,{variant:t==="Inbound"?"default":"secondary",children:s(t)})},{key:"duration",header:s("Duration"),render:t=>t?J(t):"-"},{key:"description",header:s("Description"),render:t=>t?e.jsx("span",{className:"text-sm text-gray-600 truncate max-w-xs",title:t,children:t.length>30?`${t.substring(0,30)}...`:t}):"-"},{key:"actions",header:s("Action"),render:(t,a)=>e.jsx("div",{className:"flex gap-1",children:e.jsxs(U,{children:[e.jsxs(O,{delayDuration:0,children:[e.jsx(w,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>I(a),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700",children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(E,{children:e.jsx("p",{children:s("Edit")})})]}),e.jsxs(O,{delayDuration:0,children:[e.jsx(w,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>B(a.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(E,{children:e.jsx("p",{children:s("Delete")})})]})]})})}],className:"rounded-none",emptyState:e.jsx(H,{icon:Q,title:s("No Calls found"),description:s("Get started by adding your first call."),onCreateClick:()=>i(!0),createButtonText:s("Create Call"),className:"h-auto"})})})}),e.jsx(R,{open:k,onOpenChange:t=>{i(t),t||(p(null),r({subject:"",call_type:"Outbound",duration:"",assignee:"",description:"",call_result:""}))},children:e.jsxs(q,{className:"max-w-2xl",children:[e.jsx(V,{children:e.jsx(z,{children:s(c?"Edit Call":"Create Call")})}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"subject",children:s("Subject")}),e.jsx(N,{id:"subject",type:"text",value:l.subject,onChange:t=>r({...l,subject:t.target.value}),placeholder:s("Enter call subject"),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"call_type",children:s("Call Type")}),e.jsxs(S,{value:l.call_type,onValueChange:t=>r({...l,call_type:t}),children:[e.jsx(D,{children:e.jsx(_,{placeholder:s("Select call type")})}),e.jsxs(T,{children:[e.jsx(x,{value:"Inbound",children:s("Inbound")}),e.jsx(x,{value:"Outbound",children:s("Outbound")})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"duration",children:s("Duration")}),e.jsx(N,{id:"duration",required:!0,type:"time",value:l.duration,onChange:t=>r({...l,duration:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"assignee",children:s("Assignee")}),e.jsxs(S,{value:l.assignee,onValueChange:t=>r({...l,assignee:t}),children:[e.jsx(D,{children:e.jsx(_,{placeholder:s("Select assignee")})}),e.jsx(T,{children:(C=m.user_deals)==null?void 0:C.map(t=>{var a,b,y,v;return e.jsx(x,{value:((b=(a=t.user)==null?void 0:a.id)==null?void 0:b.toString())||"",children:((y=t.user)==null?void 0:y.name)||""},(v=t.user)==null?void 0:v.id)})})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"description",children:s("Description")}),e.jsx(L,{id:"description",value:l.description,onChange:t=>r({...l,description:t.target.value}),placeholder:s("Enter call description"),rows:4})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"call_result",children:s("Call Result")}),e.jsx(M,{content:l.call_result,onChange:t=>r({...l,call_result:t}),placeholder:s("Enter call result"),className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>i(!1),children:s("Cancel")}),e.jsx(u,{type:"submit",children:s(c?"Update":"Create")})]})]})]})}),e.jsx($,{open:d.isOpen,onOpenChange:f,title:s("Delete Call"),message:d.message,confirmText:s("Delete"),onConfirm:A,variant:"destructive"})]})}export{Me as default};
