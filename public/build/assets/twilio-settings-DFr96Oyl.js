import{j as i}from"./ui-ZHFf5B17.js";import{r}from"./vendor-CcMVubkO.js";import{B as P}from"./button-DYC7yMVq.js";import{I as x}from"./input-DqOfVTcn.js";import{L as d}from"./label-DbqhUtKI.js";import{C as F,a as M,b as O,c as $}from"./card-DHszHnbI.js";import{T as u,a as z,b as B,c as D}from"./tabs-BdIH_p7Q.js";import{g as H}from"./helpers-QYnGjXad.js";import{A as R}from"./app-BBiA4mAE.js";import{S as C}from"./switch-ByWYyd_6.js";import{u as V}from"./useTranslation-CV4_gBnb.js";import{P as q}from"./phone-B_vxbsBq.js";import{S as G}from"./save-B89BgUdM.js";import{E as J}from"./eye-off-ub0Xog94.js";import{E as K}from"./eye-C8Kok_ez.js";import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";/* empty css            */import"./index-BYFX2qNQ.js";import"./createLucideIcon-Dov4NOxw.js";function hi({userSettings:o={},auth:c}){var T,b,k;const{t:e}=V(),E=((T=c==null?void 0:c.user)==null?void 0:T.activatedPackages)||[],[p,g]=r.useState({}),[j,f]=r.useState(!1),n=(k=(b=c==null?void 0:c.user)==null?void 0:b.permissions)==null?void 0:k.includes("edit-twilio-settings"),[s,_]=r.useState({twilio_notification_is:(o==null?void 0:o.twilio_notification_is)==="on",twilio_sid:(o==null?void 0:o.twilio_sid)||"",twilio_token:(o==null?void 0:o.twilio_token)||"",twilio_from:(o==null?void 0:o.twilio_from)||""}),[w,A]=r.useState(!1),[N,v]=r.useState({});r.useEffect(()=>{_({twilio_notification_is:(o==null?void 0:o.twilio_notification_is)==="on",twilio_sid:(o==null?void 0:o.twilio_sid)||"",twilio_token:(o==null?void 0:o.twilio_token)||"",twilio_from:(o==null?void 0:o.twilio_from)||""}),fetch(route("twilio.settings.index")).then(t=>t.json()).then(t=>{g(t.twilioNotifications||{});const a={};Object.values(t.twilioNotifications||{}).forEach(l=>{l.forEach(h=>{const y=`Twilio ${h.action}`;a[y]=(o==null?void 0:o[y])||"off"})}),v(a)}).catch(t=>console.error("Error fetching twilio notifications:",t))},[o]);const m=(t,a)=>{_(l=>({...l,[t]:a}))},I=(t,a)=>{v(l=>({...l,[t]:a?"on":"off"}))},L=()=>{f(!0),R.post(route("twilio.settings.store"),{settings:{...s,...N,twilio_notification_is:s.twilio_notification_is?"on":"off"}},{preserveScroll:!0,onSuccess:()=>{f(!1)},onError:()=>{f(!1)}})};return i.jsxs(F,{children:[i.jsxs(M,{className:"flex flex-row items-center justify-between",children:[i.jsxs("div",{className:"order-1 rtl:order-2",children:[i.jsxs(O,{className:"flex items-center gap-2 text-lg",children:[i.jsx(q,{className:"h-5 w-5"}),e("Twilio Settings")]}),i.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e("Configure Twilio integration and SMS settings")})]}),n&&i.jsxs(P,{className:"order-2 rtl:order-1",onClick:L,disabled:j,size:"sm",children:[i.jsx(G,{className:"h-4 w-4 mr-2"}),e(j?"Saving...":"Save Changes")]})]}),i.jsx($,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[i.jsxs("div",{children:[i.jsx(d,{htmlFor:"twilio_notification_is",className:"text-base font-medium",children:e("Enable Twilio Integration")}),i.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e("Allow SMS notifications to be sent via Twilio")})]}),i.jsx(C,{id:"twilio_notification_is",checked:s.twilio_notification_is,onCheckedChange:t=>m("twilio_notification_is",t),disabled:!n})]}),s.twilio_notification_is&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsx(d,{htmlFor:"twilio_sid",children:e("Twilio Account SID")}),i.jsx(x,{id:"twilio_sid",value:s.twilio_sid,onChange:t=>m("twilio_sid",t.target.value),placeholder:e("Enter your Twilio Account SID"),disabled:!n})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx(d,{htmlFor:"twilio_token",children:e("Twilio Auth Token")}),i.jsxs("div",{className:"relative",children:[i.jsx(x,{id:"twilio_token",type:w?"text":"password",value:s.twilio_token,onChange:t=>m("twilio_token",t.target.value),placeholder:e("Enter your Twilio Auth Token"),disabled:!n,className:"pr-10"}),i.jsx("button",{type:"button",onClick:()=>A(!w),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:w?i.jsx(J,{className:"h-4 w-4"}):i.jsx(K,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx(d,{htmlFor:"twilio_from",children:e("From Phone Number")}),i.jsx(x,{id:"twilio_from",value:s.twilio_from,onChange:t=>m("twilio_from",t.target.value),placeholder:e("Enter your Twilio phone number (e.g., +1234567890)"),disabled:!n})]}),(()=>{const t=Object.keys(p||{}).filter(a=>a.toLowerCase()==="general"||E.includes(a));return t.length>0&&i.jsxs("div",{className:"space-y-3",children:[i.jsx(d,{children:e("Notification Settings")}),i.jsxs(u,{defaultValue:t[0],children:[i.jsx(z,{className:"flex-wrap h-auto",children:t.map(a=>i.jsx(B,{value:a,className:"capitalize",children:H(a)},a))}),t.map(a=>i.jsx(D,{value:a,children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(p[a]||[]).map(l=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsx("span",{className:"text-sm font-medium",children:l.action}),i.jsx(C,{checked:N[`Twilio ${l.action}`]==="on",onCheckedChange:h=>I(`Twilio ${l.action}`,h),disabled:!n})]},l.id))})},a))]})]})})()]})]})})]})}export{hi as default};
