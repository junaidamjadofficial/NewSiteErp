import{j as t}from"./ui-ZHFf5B17.js";import A from"./ProductSelector-D7JiScTd.js";import{calculateLineItemAmounts as g}from"./TaxCalculator-m2gGkctU.js";import{B as y}from"./button-DYC7yMVq.js";import{I as j}from"./input-DqOfVTcn.js";import{I as f}from"./input-error-DuIbBMgZ.js";import{f as T}from"./helpers-QYnGjXad.js";import{u as C}from"./useTranslation-CV4_gBnb.js";import{T as P}from"./trash-2-CIuynBL1.js";import"./vendor-CcMVubkO.js";import"./select-BEhl2QER.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./chevron-down-Zr-tNTku.js";import"./createLucideIcon-Dov4NOxw.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./index-BMyiKApA.js";import"./app-BBiA4mAE.js";/* empty css            */function tt({items:i,onChange:u,errors:p,products:N=[],showAddButton:b=!0}){const{t:o}=C(),v=()=>{const s={product_id:0,quantity:1,unit_price:0,discount_percentage:0,discount_amount:0,tax_percentage:0,tax_amount:0,total_amount:0,taxes:[]};u([...i,s])},I=s=>{const a=i.filter((e,n)=>n!==s);u(a)},_=(s,a,e)=>{var r;const n=[...i];n[s]={...n[s],[a]:e};const m=n[s];if(m.tax_percentage===0&&m.product_id>0){const c=N.find(l=>l.id===m.product_id);(r=c==null?void 0:c.taxes)!=null&&r.length&&(m.tax_percentage=c.taxes.reduce((l,d)=>l+d.rate,0))}const x=g(m.quantity,m.unit_price,m.discount_percentage,m.tax_percentage);m.discount_amount=x.discountAmount,m.tax_amount=x.taxAmount,m.total_amount=x.totalAmount,u(n)},w=(s,a,e)=>{var l,d;const n=[...i],m=((l=e==null?void 0:e.taxes)==null?void 0:l.reduce((h,q)=>h+Number(q.rate),0))||0,x=((d=e==null?void 0:e.taxes)==null?void 0:d.map(h=>({tax_name:h.tax_name,tax_rate:h.rate})))||[];n[s]={...n[s],product_id:a,unit_price:Number(e==null?void 0:e.purchase_price)||0,tax_percentage:Number(m)||0,taxes:x};const r=n[s];r.quantity=Number(r.quantity)||1,r.discount_percentage=Number(r.discount_percentage)||0;const c=g(r.quantity,r.unit_price,r.discount_percentage,r.tax_percentage);r.discount_amount=Number(c.discountAmount)||0,r.tax_amount=Number(c.taxAmount)||0,r.total_amount=Number(c.totalAmount)||0,u(n)};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-border",children:[t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[o("Product")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[o("Qty")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[o("Unit Price")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[o("Discount")," %"]}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:o("Tax")}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:o("Total")}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-foreground",children:o("Action")})]})}),t.jsx("tbody",{className:"divide-y divide-border",children:i.map((s,a)=>t.jsxs("tr",{children:[t.jsxs("td",{className:"px-4 py-4",children:[t.jsx(A,{products:N,value:s.product_id,onChange:(e,n)=>w(a,e,n)}),t.jsx(f,{message:p[`items.${a}.product_id`]})]}),t.jsxs("td",{className:"px-4 py-4",children:[t.jsx(j,{type:"number",value:s.quantity,onChange:e=>_(a,"quantity",parseInt(e.target.value)||0),className:"w-20 text-sm",min:"1",step:"1",required:!0}),t.jsx(f,{message:p[`items.${a}.quantity`]})]}),t.jsxs("td",{className:"px-4 py-4",children:[t.jsx(j,{type:"number",value:s.unit_price,onChange:e=>_(a,"unit_price",parseFloat(e.target.value)||0),className:"w-24 text-sm",min:"0",step:"0.01",required:!0}),t.jsx(f,{message:p[`items.${a}.unit_price`]})]}),t.jsx("td",{className:"px-4 py-4",children:t.jsx(j,{type:"number",value:s.discount_percentage,onChange:e=>_(a,"discount_percentage",parseFloat(e.target.value)||0),className:"w-20 text-sm",min:"0",max:"100",step:"0.01"})}),t.jsx("td",{className:"px-4 py-4",children:s.taxes&&s.taxes.length>0?t.jsx("div",{className:"flex flex-wrap gap-1",children:s.taxes.map((e,n)=>t.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.tax_name," (",e.tax_rate,"%)"]},n))}):s.tax_percentage>0?t.jsxs("span",{className:"text-sm text-blue-800",children:["Tax (",s.tax_percentage,"%)"]}):t.jsx("span",{className:"text-sm text-muted-foreground",children:"No tax"})}),t.jsx("td",{className:"px-4 py-4",children:t.jsx("span",{className:"text-sm font-medium",children:T(s.total_amount)})}),t.jsx("td",{className:"px-4 py-4 text-center",children:t.jsx(y,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(a),className:"text-red-600 hover:text-red-800 h-8 w-8 p-0",children:t.jsx(P,{className:"h-4 w-4"})})})]},a))})]})}),b&&t.jsx("div",{className:"flex justify-start",children:t.jsxs(y,{type:"button",onClick:v,variant:"default",size:"sm",children:["+ ",o("Add Item")]})}),t.jsx(f,{message:p.items})]})}export{tt as default};
