import{j as e}from"./ui-ZHFf5B17.js";import{r as i}from"./vendor-CcMVubkO.js";import{B as k}from"./button-DYC7yMVq.js";import{L as p}from"./label-DbqhUtKI.js";import{C as F,a as J,b as O,c as A}from"./card-DHszHnbI.js";import{t as E,A as I}from"./app-BBiA4mAE.js";import{S as T}from"./switch-ByWYyd_6.js";import{T as D}from"./textarea-DxQ_BnuT.js";import{I as C}from"./input-DqOfVTcn.js";import{u as L}from"./useTranslation-CV4_gBnb.js";import{C as P}from"./calendar-DvmJ2XsD.js";import{S as z}from"./save-B89BgUdM.js";import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";/* empty css            */import"./index-BYFX2qNQ.js";import"./createLucideIcon-Dov4NOxw.js";function oe({userSettings:a={},auth:t}){var f,h;const{t:l}=L(),[_,m]=i.useState(!1),r=(h=(f=t==null?void 0:t.user)==null?void 0:f.permissions)==null?void 0:h.includes("edit-google-calendar-settings"),[n,g]=i.useState({google_calendar_enable:(a==null?void 0:a.google_calendar_enable)==="on",google_calendar_json_file:(a==null?void 0:a.google_calendar_json_file)||"",google_calendar_id:(a==null?void 0:a.google_calendar_id)||""}),[d,j]=i.useState(null);i.useEffect(()=>{g({google_calendar_enable:(a==null?void 0:a.google_calendar_enable)==="on",google_calendar_json_file:(a==null?void 0:a.google_calendar_json_file)||"",google_calendar_id:(a==null?void 0:a.google_calendar_id)||""})},[a]);const x=(o,s)=>{g(c=>({...c,[o]:s}))},v=o=>{var c;const s=(c=o.target.files)==null?void 0:c[0];if(s&&s.type==="application/json"){j(s);const b=new FileReader;b.onload=w=>{var N;const G=(N=w.target)==null?void 0:N.result;g(y=>({...y,google_calendar_json_file:G}))},b.readAsText(s)}else E.error(l("Please select a valid JSON file"))},u=()=>{m(!0);const o=new FormData;o.append("settings[google_calendar_enable]",n.google_calendar_enable?"on":"off"),o.append("settings[google_calendar_id]",n.google_calendar_id),d||o.append("settings[google_calendar_json_file]",n.google_calendar_json_file),d&&o.append("json_file",d),I.post(route("calendar.settings.store"),o,{preserveScroll:!0,onSuccess:()=>{m(!1),j(null)},onError:()=>{m(!1)}})};return e.jsxs(F,{children:[e.jsxs(J,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"order-1 rtl:order-2",children:[e.jsxs(O,{className:"flex items-center gap-2 text-lg",children:[e.jsx(P,{className:"h-5 w-5"}),l("Google Calendar Settings")]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l("Configure Google Calendar integration settings")})]}),r&&e.jsxs(k,{className:"order-2 rtl:order-1",onClick:u,disabled:_,size:"sm",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),l(_?"Saving...":"Save Changes")]})]}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"google_calendar_enable",className:"text-base font-medium",children:l("Enable Google Calendar Integration")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l("Allow events to be synced with Google Calendar")})]}),e.jsx(T,{id:"google_calendar_enable",checked:n.google_calendar_enable,onCheckedChange:o=>x("google_calendar_enable",o),disabled:!r})]}),n.google_calendar_enable&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"google_calendar_id",children:l("Google Calendar ID")}),e.jsx(C,{id:"google_calendar_id",type:"text",value:n.google_calendar_id,onChange:o=>x("google_calendar_id",o.target.value),placeholder:l("your-calendar@gmail.com or calendar-id"),disabled:!r}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l("Find this in Google Calendar Settings → Calendar ID")})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"google_calendar_json_file",children:l("Google Calendar JSON File")}),e.jsxs("div",{className:"space-y-2",children:[a!=null&&a.google_calendar_json_file?e.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:l("Google Calendar JSON configuration saved.")})}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:l("To start the synchronization process, please insert your Google OAuth 2.0 JSON below.")}),e.jsx(C,{type:"file",accept:".json",onChange:v,disabled:!r}),d&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:[l("Selected"),": ",d.name]})]}),e.jsx(D,{id:"google_calendar_json_file",value:n.google_calendar_json_file,onChange:o=>x("google_calendar_json_file",o.target.value),placeholder:l("Enter Google Calendar service account JSON configuration or upload a file"),disabled:!r,rows:6})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 border rounded-lg p-4 bg-blue-50 dark:bg-blue-950/20",children:[e.jsx("h4",{className:"font-medium mb-3 text-blue-900 dark:text-blue-100",children:l("How to get Google Calendar JSON File")}),e.jsxs("div",{className:"space-y-2 text-sm text-blue-800 dark:text-blue-200",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium min-w-[20px]",children:"1."}),e.jsxs("span",{children:[l("Go to")," ",e.jsx("a",{href:"https://console.cloud.google.com/",target:"_blank",rel:"noopener noreferrer",className:"underline hover:no-underline",children:"Google Cloud Console"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium min-w-[20px]",children:"2."}),e.jsx("span",{children:l("Create a new project or select existing one")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium min-w-[20px]",children:"3."}),e.jsx("span",{children:l("Enable Google Calendar API in APIs & Services")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium min-w-[20px]",children:"4."}),e.jsx("span",{children:l("Go to Credentials → Create Credentials → Service Account")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium min-w-[20px]",children:"5."}),e.jsx("span",{children:l("Create service account and download JSON key file")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium min-w-[20px]",children:"6."}),e.jsx("span",{children:l("Upload the JSON file above or paste its content")})]})]})]})]})})]})})]})}export{oe as default};
