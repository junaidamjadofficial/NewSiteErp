import{j as t}from"./ui-ZHFf5B17.js";import A from"./ProductSelector-BlkJM2mq.js";import{calculateLineItemAmounts as g}from"./TaxCalculator-D6N5_xfS.js";import{B as y}from"./button-DYC7yMVq.js";import{I as N}from"./input-DqOfVTcn.js";import{I as h}from"./input-error-DuIbBMgZ.js";import{f as T}from"./helpers-QYnGjXad.js";import{u as k}from"./useTranslation-CV4_gBnb.js";import{T as C}from"./trash-2-CIuynBL1.js";import"./vendor-CcMVubkO.js";import"./select-BEhl2QER.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./chevron-down-Zr-tNTku.js";import"./createLucideIcon-Dov4NOxw.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./index-BMyiKApA.js";import"./app-BBiA4mAE.js";/* empty css            */function tt({items:l,onChange:u,errors:d,products:_=[],showAddButton:b=!0}){const{t:m}=k(),v=()=>{const s={product_id:0,quantity:1,unit_price:0,discount_percentage:0,discount_amount:0,tax_percentage:0,tax_amount:0,total_amount:0,taxes:[]};u([...l,s])},I=s=>{const r=l.filter((e,a)=>a!==s);u(r)},j=(s,r,e)=>{var o;const a=[...l];a[s]={...a[s],[r]:e};const n=a[s];if(n.tax_percentage===0&&n.product_id>0){const c=_.find(i=>i.id===n.product_id);(o=c==null?void 0:c.taxes)!=null&&o.length&&(n.tax_percentage=c.taxes.reduce((i,p)=>i+p.rate,0))}const x=g(n.quantity,n.unit_price,n.discount_percentage,n.tax_percentage);n.discount_amount=x.discountAmount,n.tax_amount=x.taxAmount,n.total_amount=x.totalAmount,u(a)},q=(s,r,e)=>{var i,p;const a=[...l],n=((i=e==null?void 0:e.taxes)==null?void 0:i.reduce((f,w)=>f+Number(w.rate),0))||0,x=((p=e==null?void 0:e.taxes)==null?void 0:p.map(f=>({tax_name:f.tax_name,tax_rate:f.rate})))||[];a[s]={...a[s],product_id:r,unit_price:Number(e==null?void 0:e.sale_price)||0,tax_percentage:Number(n)||0,taxes:x};const o=a[s];o.quantity=Number(o.quantity)||1,o.discount_percentage=Number(o.discount_percentage)||0;const c=g(o.quantity,o.unit_price,o.discount_percentage,o.tax_percentage);o.discount_amount=Number(c.discountAmount)||0,o.tax_amount=Number(c.taxAmount)||0,o.total_amount=Number(c.totalAmount)||0,u(a)};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-border",children:[t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[m("Product")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[m("Qty")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[m("Unit Price")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:[m("Discount")," %"]}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:m("Tax")}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-foreground",children:m("Total")}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-foreground",children:m("Action")})]})}),t.jsx("tbody",{className:"divide-y divide-border",children:l.map((s,r)=>t.jsxs("tr",{children:[t.jsxs("td",{className:"px-4 py-4",children:[t.jsx(A,{products:_,value:s.product_id,onChange:(e,a)=>q(r,e,a)}),t.jsx(h,{message:d[`items.${r}.product_id`]})]}),t.jsxs("td",{className:"px-4 py-4",children:[(()=>{const e=_.find(n=>n.id===s.product_id),a=(e==null?void 0:e.stock_quantity)||999999;return t.jsxs("div",{children:[t.jsx(N,{type:"number",value:s.quantity,onChange:n=>j(r,"quantity",parseInt(n.target.value)||0),className:"w-20 text-sm",min:"1",max:a,step:"1",required:!0}),e&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[m("Stock"),": ",e.stock_quantity||0]})]})})(),t.jsx(h,{message:d[`items.${r}.quantity`]})]}),t.jsxs("td",{className:"px-4 py-4",children:[t.jsx(N,{type:"number",value:s.unit_price,onChange:e=>j(r,"unit_price",parseFloat(e.target.value)||0),className:"w-24 text-sm",min:"0",step:"0.01",required:!0}),t.jsx(h,{message:d[`items.${r}.unit_price`]})]}),t.jsx("td",{className:"px-4 py-4",children:t.jsx(N,{type:"number",value:s.discount_percentage,onChange:e=>j(r,"discount_percentage",parseFloat(e.target.value)||0),className:"w-20 text-sm",min:"0",max:"100",step:"0.01"})}),t.jsx("td",{className:"px-4 py-4",children:s.taxes&&s.taxes.length>0?t.jsx("div",{className:"flex flex-wrap gap-1",children:s.taxes.map((e,a)=>t.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.tax_name," (",e.tax_rate,"%)"]},a))}):s.tax_percentage>0?t.jsxs("span",{className:"text-sm text-blue-800",children:["Tax (",s.tax_percentage,"%)"]}):t.jsx("span",{className:"text-sm text-muted-foreground",children:"No tax"})}),t.jsx("td",{className:"px-4 py-4",children:t.jsx("span",{className:"text-sm font-medium",children:T(s.total_amount)})}),t.jsx("td",{className:"px-4 py-4 text-center",children:t.jsx(y,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(r),className:"text-red-600 hover:text-red-800 h-8 w-8 p-0",children:t.jsx(C,{className:"h-4 w-4"})})})]},r))})]})}),b&&t.jsx("div",{className:"flex justify-start",children:t.jsxs(y,{type:"button",onClick:v,variant:"default",size:"sm",children:["+ ",m("Add Item")]})}),t.jsx(h,{message:d.items})]})}export{tt as default};
