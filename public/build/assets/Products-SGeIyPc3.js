import{j as e}from"./ui-ZHFf5B17.js";import{r as a}from"./vendor-CcMVubkO.js";import{A as g}from"./app-BBiA4mAE.js";import{D as w}from"./data-table--afTq2As.js";import{B as d}from"./button-DYC7yMVq.js";import{D as k,a as A,b as O,c as E}from"./dialog-BLwxprq_.js";import{L as M}from"./label-DbqhUtKI.js";import{M as B}from"./multi-select-enhanced-C0hF2-Yw.js";import{T as I,a as F,b as L,c as _}from"./tooltip-C7wT1CW2.js";import{C as $}from"./confirmation-dialog-mYyCtWPl.js";import{N as z}from"./no-records-found-C2RGIdAh.js";import{u as G}from"./useTranslation-CV4_gBnb.js";import{P as R}from"./package-rNDE_pCr.js";import{T as V}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./input-DqOfVTcn.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./popover-fYI5j510.js";import"./badge-CV60sqBJ.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./index-BZAHB8Ku.js";import"./plus-C1hmRCnY.js";function Ne({lead:r,onRegisterAddHandler:m}){a.useEffect(()=>{m(()=>h())},[m]);const{t}=G(),[P,c]=a.useState(!1),[v,D]=a.useState([]),[i,p]=a.useState([]),[b,y]=a.useState({}),[n,u]=a.useState({isOpen:!1,productId:null,message:""}),N=async()=>{try{const s=await(await fetch(route("lead.leads.available-products",r.id))).json();D(s.map(l=>({value:l.id.toString(),label:l.name})))}catch{}},S=()=>{i.length!==0&&g.post(route("lead.leads.assign-products",r.id),{product_ids:i.map(o=>parseInt(o))},{onSuccess:()=>{c(!1),p([])}})},h=()=>{N(),c(!0)},C=o=>{u({isOpen:!0,productId:o,message:t("Are you sure you want to delete this product?")})},f=()=>{u({isOpen:!1,productId:null,message:""})},T=()=>{n.productId&&(g.delete(route("lead.leads.remove-product",{lead:r.id,product:n.productId})),f())};return a.useEffect(()=>{(async()=>{if(r.products)try{const l=await(await fetch(route("lead.leads.available-products",r.id))).json(),x={};l.forEach(j=>{x[j.id]=j.name}),y(x)}catch{}})()},[r.products]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(w,{data:r.products?[...new Set(r.products.split(",").filter(Boolean).map(o=>o.trim()))].map((o,s)=>({id:o,key:`product-${o}-${s}`,name:b[o]||""})):[],columns:[{key:"name",header:t("Product Name"),render:(o,s)=>s.name||""},{key:"actions",header:t("Action"),render:(o,s)=>e.jsx("div",{className:"flex gap-1",children:e.jsx(I,{children:e.jsxs(F,{delayDuration:0,children:[e.jsx(L,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{C(s.id)},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(V,{className:"h-4 w-4"})})}),e.jsx(_,{children:e.jsx("p",{children:t("Delete Product")})})]})})})}],className:"rounded-none",emptyState:e.jsx(z,{icon:R,title:t("No Products added"),description:t("Get started by adding products to this lead."),onCreateClick:()=>h(),createButtonText:t("Add Products"),className:"h-auto"})})})}),e.jsx(k,{open:P,onOpenChange:c,children:e.jsxs(A,{className:"max-w-md",children:[e.jsx(O,{children:e.jsx(E,{children:t("Add Products")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{children:t("Select Products")}),e.jsx(B,{options:v,value:i,onValueChange:p,placeholder:t("Select products"),searchable:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>c(!1),children:t("Cancel")}),e.jsx(d,{onClick:S,disabled:i.length===0,children:t("Save")})]})]})]})}),e.jsx($,{open:n.isOpen,onOpenChange:f,title:t("Delete Product"),message:n.message,confirmText:t("Delete"),onConfirm:T,variant:"destructive"})]})}export{Ne as default};
