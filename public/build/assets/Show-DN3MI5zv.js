import{j as e}from"./ui-ZHFf5B17.js";import{r as w}from"./vendor-CcMVubkO.js";import{G as D,A as E}from"./app-BBiA4mAE.js";import I from"./SupportTicketLayout-pQfutyf3.js";import{C as x,c as p}from"./card-DHszHnbI.js";import{B as k}from"./button-DYC7yMVq.js";import{R as P}from"./rich-text-editor-59agrfWF.js";import{D as $}from"./index-DzHyjDkQ.js";import{k as u}from"./helpers-QYnGjXad.js";import{u as O}from"./useTranslation-CV4_gBnb.js";import{T as y}from"./ticket-CPT2TfbK.js";import{P as v}from"./paperclip-C_mZqrNn.js";import{D as C}from"./download-DpWzK9fg.js";import{S as F}from"./send-J2b8i-sO.js";/* empty css            */import"./useFormFields-BwNmEYJY.js";import"./tooltip-C7wT1CW2.js";import"./index-BZAHB8Ku.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./label-DbqhUtKI.js";import"./index-BMyiKApA.js";import"./textarea-DxQ_BnuT.js";import"./select-BEhl2QER.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./input-DqOfVTcn.js";import"./chevron-down-Zr-tNTku.js";import"./createLucideIcon-Dov4NOxw.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./radio-group-Bg6nc_Xb.js";import"./circle-bmoNtd-e.js";import"./slider-CIevYFX0.js";import"./dialog-BLwxprq_.js";import"./x-DVK_F_Gh.js";import"./sparkles-yKnt-shd.js";import"./input-error-DuIbBMgZ.js";import"./switch-ByWYyd_6.js";import"./index-Chjiymov.js";import"./index-8JwjhRSi.js";import"./badge-CV60sqBJ.js";import"./circle-help-CE56Mn6R.js";import"./headphones-BkxDRJ_v.js";import"./menu-CO-7TdWM.js";import"./index-DaFL_H0m.js";import"./with-selector-CP8JaRn2.js";import"./undo-D3tFEvb3.js";import"./list-BVwWsOhE.js";import"./link-2Bt5o4zZ.js";function Oe({ticket:t,workspace:B,settings:S,brandSettings:_,slug:R}){const{t:l}=O(),[d,b]=w.useState(null),[j,h]=w.useState([]),{data:f,setData:T,processing:g,errors:H,reset:A}=D({reply_description:""}),L=s=>{s.preventDefault();const a=new FormData;if(a.append("description",f.reply_description),d&&d.length>0)for(let i=0;i<d.length;i++)a.append("files[]",d[i]);window.location.pathname.includes("/support-tickets/");const r=window.location.pathname.split("/"),m=r[r.length-1];E.post($("support-ticket.send-conversion.store",{slug:R,ticketId:m}),a,{onSuccess:()=>{A(),b(null),h([])},onError:i=>{}})},N=s=>u(s),U=s=>({open:"bg-green-100 text-green-800",Open:"bg-green-100 text-green-800","In Progress":"bg-blue-100 text-blue-800",closed:"bg-red-100 text-red-800",Closed:"bg-red-100 text-red-800","On Hold":"bg-yellow-100 text-yellow-800"})[s]||"bg-gray-100 text-gray-800";return e.jsxs(I,{title:`Ticket - ${t.ticket_id}`,settings:S,brandSettings:_,children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("div",{className:"inline-block bg-teal-600 text-white px-6 py-3 rounded-full shadow-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-5 w-5"}),e.jsxs("span",{className:"font-semibold",children:[l("Ticket")," - ",t.ticket_id]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(x,{className:"shadow-md mb-6",children:e.jsxs(p,{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-y-2",children:[e.jsx("h2",{className:"md:text-2xl text-xl font-bold text-gray-800",children:t.subject}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${U(t.status)}`,children:t.status})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Created:"}),e.jsx("span",{className:"font-medium",children:u(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Customer:"}),e.jsx("span",{className:"font-medium",children:t.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Email:"}),e.jsx("span",{className:"font-medium",children:t.email})]})]})]})}),e.jsxs("div",{className:"space-y-6 mb-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-teal-400 flex items-center justify-center text-white font-semibold",children:t.name?t.name.charAt(0).toUpperCase():"U"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["(",N(t.created_at),")"]})]})}),e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 rounded-xl p-4 transition-all duration-300 hover:-translate-y-1 hover:shadow-md",children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:t.description}}),t.attachments&&Array.isArray(t.attachments)&&t.attachments.length>0&&e.jsxs("div",{className:"mt-4 bg-white/50 rounded-lg p-3 border border-blue-100",children:[e.jsxs("b",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{className:"h-4 w-4"}),"Attachments:"]}),t.attachments.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:s.name}),e.jsx("button",{onClick:async()=>{const r=`/storage/${s.path}`,i=await(await fetch(r)).blob(),n=document.createElement("a");n.href=URL.createObjectURL(i),n.download=s.name,n.click(),URL.revokeObjectURL(n.href)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(C,{className:"h-4 w-4"})})]},a))]})]})]})]}),t.conversions&&t.conversions.map(s=>{var a;return e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-green-400 flex items-center justify-center text-white font-semibold",children:s.sender==="admin"?"A":"U"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.sender==="admin"?((a=s.replyBy)==null?void 0:a.name)||"Admin":t.name}),e.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["(",N(s.created_at),")"]})]})}),e.jsxs("div",{className:`rounded-xl p-4 transition-all duration-300 hover:-translate-y-1 hover:shadow-md ${s.sender==="admin"?"bg-green-50 border-l-4 border-green-400":"bg-blue-50 border-l-4 border-blue-400"}`,children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:s.description||"No description"}}),s.attachments&&Array.isArray(s.attachments)&&s.attachments.length>0&&e.jsxs("div",{className:"mt-4 bg-white/50 rounded-lg p-3 border border-blue-100",children:[e.jsxs("b",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{className:"h-4 w-4"}),"Attachments:"]}),s.attachments.map((r,m)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:r.name}),e.jsx("button",{onClick:async()=>{const i=`/storage/${r.path}`,o=await(await fetch(i)).blob(),c=document.createElement("a");c.href=URL.createObjectURL(o),c.download=r.name,c.click(),URL.revokeObjectURL(c.href)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(C,{className:"h-4 w-4"})})]},m))]})]})]})]},s.id)})]}),t.status!=="Closed"?e.jsx(x,{className:"shadow-md overflow-hidden",children:e.jsx(p,{className:"p-4",children:e.jsxs("form",{onSubmit:L,children:[e.jsx(P,{content:f.reply_description,onChange:s=>T("reply_description",s),placeholder:"Write your reply here...",className:"mb-4"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:l("Attachments")}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:s=>{if(b(s.target.files),s.target.files){const a=[];for(let r=0;r<s.target.files.length;r++){const m=s.target.files[r],i=new FileReader;i.onload=n=>{var o;a.push((o=n.target)==null?void 0:o.result),a.length===s.target.files.length&&h(a)},i.readAsDataURL(m)}}else h([])},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100"}),j.length>0&&e.jsx("div",{className:"mt-3 grid grid-cols-3 gap-2",children:j.map((s,a)=>e.jsx("img",{src:s,alt:`Preview ${a+1}`,className:"w-full h-20 object-cover rounded border"},a))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(k,{type:"submit",disabled:g||!f.reply_description.trim(),className:"bg-teal-600 hover:bg-teal-700",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),l(g?"Sending...":"Send Reply")]})})]})})}):e.jsx(x,{children:e.jsx(p,{className:"p-4 text-center text-gray-600",children:l("Ticket is closed and cannot receive replies.")})})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(x,{className:"shadow-md overflow-hidden",children:[e.jsx("div",{className:"bg-teal-600 text-white py-3 px-4",children:e.jsxs("h3",{className:"font-medium flex items-center",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),l("Ticket Information")]})}),e.jsx(p,{className:"p-4 space-y-4",children:[{label:l("Status"),value:t.status},{label:l("Ticket ID"),value:`#${t.ticket_id}`},{label:l("Created"),value:u(t.created_at)},{label:l("Customer"),value:t.name},{label:l("Email"),value:t.email}].map((s,a)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:[s.label,":"]}),e.jsx("span",{className:"font-medium text-gray-900",children:s.value})]},a))})]})})]})]})}export{Oe as default};
