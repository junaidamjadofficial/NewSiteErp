import{j as e}from"./ui-ZHFf5B17.js";import{r as d}from"./vendor-CcMVubkO.js";import{A as f}from"./app-BBiA4mAE.js";import{u as q}from"./useDeleteHandler-BcjiOXkX.js";import{D as H}from"./data-table--afTq2As.js";import{B as u}from"./button-DYC7yMVq.js";import{D as M,a as P,b as B,c as A}from"./dialog-BLwxprq_.js";import{S as y,a as k,b as v,c as T,d as m}from"./select-BEhl2QER.js";import{L as c}from"./label-DbqhUtKI.js";import{I}from"./input-DqOfVTcn.js";import{D as V}from"./date-picker-CVthJV3y.js";import{T as z,a as C,b as D,c as S}from"./tooltip-C7wT1CW2.js";import{C as $}from"./confirmation-dialog-mYyCtWPl.js";import{N as R}from"./no-records-found-C2RGIdAh.js";import{m as U,a as w}from"./helpers-QYnGjXad.js";import{u as J}from"./useFormFields-BwNmEYJY.js";import{u as K}from"./useTranslation-CV4_gBnb.js";import{S as Q}from"./square-check-big-jIi-JzLQ.js";import{S as W}from"./square-pen-D0WnMiRU.js";import{T as X}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./react-datepicker-BHcKmBHW.js";import"./popover-fYI5j510.js";import"./calendar-DvmJ2XsD.js";import"./plus-C1hmRCnY.js";import"./textarea-DxQ_BnuT.js";import"./radio-group-Bg6nc_Xb.js";import"./circle-bmoNtd-e.js";import"./slider-CIevYFX0.js";import"./sparkles-yKnt-shd.js";import"./input-error-DuIbBMgZ.js";import"./switch-ByWYyd_6.js";import"./index-Chjiymov.js";import"./index-8JwjhRSi.js";import"./badge-CV60sqBJ.js";function We({deal:h,onRegisterAddHandler:x}){const{t:r}=K();d.useEffect(()=>{x(()=>l(!0))},[x]);const[b,l]=d.useState(!1),[a,p]=d.useState(null),[i,o]=d.useState({name:"",date:"",time:"",priority:"Low",status:"On Going",sync_to_google_calendar:!1}),N=J("createCalendarSyncField",i,(t,s)=>{o(n=>({...n,[t]:s}))},{},"create",r,"Lead"),{deleteState:g,openDeleteDialog:O,closeDeleteDialog:L,confirmDelete:F}=q({routeName:"deal.tasks.destroy",defaultMessage:r("Are you sure you want to delete this task?")}),E=t=>{t.preventDefault(),a?f.put(route("deal.tasks.update",a.id),i,{onSuccess:()=>{o({name:"",date:"",time:"",priority:"Low",status:"On Going"}),l(!1),p(null)}}):f.post(route("deal.tasks.store"),{deal_id:h.id,...i},{onSuccess:()=>{o({name:"",date:"",time:"",priority:"Low",status:"On Going"}),l(!1)}})},G=t=>{p(t),l(!0)};return d.useEffect(()=>{if(a){let t="";if(a.date){const s=a.date.toString();s.includes("T")?t=s.split("T")[0]:t=s}o({name:a.name||"",date:t,time:a.time||"",priority:a.priority||"Low",status:a.status||"On Going"})}else o({name:"",date:"",time:"",priority:"Low",status:"On Going"})},[a]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(H,{data:h.tasks||[],columns:[{key:"name",header:r("Name")},{key:"date",header:r("Date"),render:(t,s)=>{const n=new Date(t),j=new Date;j.setHours(0,0,0,0),n.setHours(0,0,0,0);const _=n<j&&s.status!=="Complete";return e.jsx("span",{className:_?"text-red-600 font-medium":"",children:w(t)})}},{key:"time",header:r("Time"),render:t=>U(t)},{key:"priority",header:r("Priority"),render:t=>{const s=n=>{switch(n){case"Low":return"bg-green-100 text-green-800";case"Medium":return"bg-yellow-100 text-yellow-800";case"High":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${s(t)}`,children:r(t)})}},{key:"status",header:r("Status"),render:t=>{const s=n=>{switch(n){case"On Going":return"bg-yellow-100 text-yellow-800";case"Complete":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${s(t)}`,children:r(t)})}},{key:"actions",header:r("Action"),render:(t,s)=>e.jsx("div",{className:"flex gap-1",children:e.jsxs(z,{children:[e.jsxs(C,{delayDuration:0,children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>G(s),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700",children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(S,{children:e.jsx("p",{children:r("Edit")})})]}),e.jsxs(C,{delayDuration:0,children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>O(s.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(S,{children:e.jsx("p",{children:r("Delete")})})]})]})})}],className:"rounded-none",emptyState:e.jsx(R,{icon:Q,title:r("No Tasks found"),description:r("Get started by creating your first Task."),onCreateClick:()=>l(!0),createButtonText:r("Create Task"),className:"h-auto"})})})}),e.jsx(M,{open:b,onOpenChange:t=>{l(t),t||(p(null),o({name:"",date:"",time:"",priority:"Low",status:"On Going"}))},children:e.jsxs(P,{className:"max-w-md",children:[e.jsx(B,{children:e.jsx(A,{children:r(a?"Edit Task":"Create Task")})}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{required:!0,children:r("Name")}),e.jsx("input",{type:"text",value:i.name,onChange:t=>o({...i,name:t.target.value}),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md",placeholder:r("Enter task name"),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(c,{required:!0,children:r("Date")}),e.jsx(V,{value:i.date,onChange:t=>o({...i,date:w(t)}),placeholder:r("Select Date")})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"start_time",children:r("Time")}),e.jsx(I,{id:"start_time",required:!0,type:"time",value:i.time,onChange:t=>o({...i,time:t.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"priority",children:r("Priority")}),e.jsxs(y,{value:i.priority,onValueChange:t=>o({...i,priority:t}),children:[e.jsx(k,{children:e.jsx(v,{placeholder:r("Select priority")})}),e.jsxs(T,{children:[e.jsx(m,{value:"Low",children:r("Low")}),e.jsx(m,{value:"Medium",children:r("Medium")}),e.jsx(m,{value:"High",children:r("High")})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"status",children:r("Status")}),e.jsxs(y,{value:i.status,onValueChange:t=>o({...i,status:t}),children:[e.jsx(k,{children:e.jsx(v,{placeholder:r("Select status")})}),e.jsxs(T,{children:[e.jsx(m,{value:"On Going",children:r("On Going")}),e.jsx(m,{value:"Complete",children:r("Complete")})]})]})]})]}),!a&&N.map(t=>e.jsx("div",{children:t.component},t.id)),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>l(!1),children:r("Cancel")}),e.jsx(u,{type:"submit",children:r(a?"Update":"Save")})]})]})]})}),e.jsx($,{open:g.isOpen,onOpenChange:L,title:r("Delete Task"),message:g.message,confirmText:r("Delete"),onConfirm:F,variant:"destructive"})]})}export{We as default};
