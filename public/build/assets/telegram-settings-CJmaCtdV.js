import{j as a}from"./ui-ZHFf5B17.js";import{r as m}from"./vendor-CcMVubkO.js";import{B as I}from"./button-DYC7yMVq.js";import{I as v}from"./input-DqOfVTcn.js";import{L as d}from"./label-DbqhUtKI.js";import{C as O,a as A,b as F,c as B}from"./card-DHszHnbI.js";import{A as P}from"./app-BBiA4mAE.js";import{S as C}from"./switch-ByWYyd_6.js";import{T as $,a as z,b as D,c as H}from"./tabs-BdIH_p7Q.js";import{g as R}from"./helpers-QYnGjXad.js";import{u as V}from"./useTranslation-CV4_gBnb.js";import{S as q}from"./send-J2b8i-sO.js";import{S as G}from"./save-B89BgUdM.js";import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";/* empty css            */import"./index-BYFX2qNQ.js";import"./createLucideIcon-Dov4NOxw.js";function ce({userSettings:t={},auth:s}){var b,N,T;const{t:o}=V(),g=((b=s==null?void 0:s.user)==null?void 0:b.activatedPackages)||[],[c,y]=m.useState({}),[_,f]=m.useState(!1),n=(T=(N=s==null?void 0:s.user)==null?void 0:N.permissions)==null?void 0:T.includes("edit-telegram-settings"),[l,x]=m.useState({telegram_notification_is:(t==null?void 0:t.telegram_notification_is)==="on",telegram_bot_token:(t==null?void 0:t.telegram_bot_token)||"",telegram_chat_id:(t==null?void 0:t.telegram_chat_id)||""}),[p,j]=m.useState({});m.useEffect(()=>{x({telegram_notification_is:(t==null?void 0:t.telegram_notification_is)==="on",telegram_bot_token:(t==null?void 0:t.telegram_bot_token)||"",telegram_chat_id:(t==null?void 0:t.telegram_chat_id)||""}),fetch(route("telegram.settings.index")).then(e=>e.json()).then(e=>{y(e.telegramNotifications||{});const i={};Object.values(e.telegramNotifications||{}).forEach(r=>{r.forEach(L=>{const k=`Telegram ${L.action}`;i[k]=(t==null?void 0:t[k])||"off"})}),j(i)}).catch(e=>console.error("Error fetching telegram notifications:",e))},[t]);const h=(e,i)=>{x(r=>({...r,[e]:i}))},w=(e,i)=>{j(r=>({...r,[e]:i?"on":"off"}))},E=()=>{f(!0),P.post(route("telegram.settings.store"),{settings:{...l,...p,telegram_notification_is:l.telegram_notification_is?"on":"off"}},{preserveScroll:!0,onSuccess:()=>{f(!1)},onError:()=>{f(!1)}})};return a.jsxs(O,{children:[a.jsxs(A,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{className:"order-1 rtl:order-2",children:[a.jsxs(F,{className:"flex items-center gap-2 text-lg",children:[a.jsx(q,{className:"h-5 w-5"}),o("Telegram Settings")]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:o("Configure Telegram bot integration settings")})]}),n&&a.jsxs(I,{className:"order-2 rtl:order-1",onClick:E,disabled:_,size:"sm",children:[a.jsx(G,{className:"h-4 w-4 mr-2"}),o(_?"Saving...":"Save Changes")]})]}),a.jsx(B,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{children:[a.jsx(d,{htmlFor:"telegram_notification_is",className:"text-base font-medium",children:o("Enable Telegram Integration")}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:o("Allow notifications to be sent to Telegram")})]}),a.jsx(C,{id:"telegram_notification_is",checked:l.telegram_notification_is,onCheckedChange:e=>h("telegram_notification_is",e),disabled:!n})]}),l.telegram_notification_is&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx(d,{htmlFor:"telegram_bot_token",children:o("Telegram Bot Token")}),a.jsx(v,{id:"telegram_bot_token",value:l.telegram_bot_token,onChange:e=>h("telegram_bot_token",e.target.value),placeholder:o("Enter Telegram bot token"),disabled:!n})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(d,{htmlFor:"telegram_chat_id",children:o("Telegram Chat ID")}),a.jsx(v,{id:"telegram_chat_id",value:l.telegram_chat_id,onChange:e=>h("telegram_chat_id",e.target.value),placeholder:o("Enter Telegram chat ID"),disabled:!n})]}),Object.keys(c||{}).filter(e=>e.toLowerCase()==="general"||g.includes(e)).length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsx(d,{children:o("Notification Settings")}),a.jsxs($,{defaultValue:Object.keys(c||{})[0],children:[a.jsx(z,{className:"flex-wrap h-auto",children:Object.keys(c||{}).filter(e=>e.toLowerCase()==="general"||g.includes(e)).map(e=>a.jsx(D,{value:e,className:"capitalize",children:R(e)},e))}),Object.keys(c||{}).filter(e=>e.toLowerCase()==="general"||g.includes(e)).map(e=>a.jsx(H,{value:e,children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(c[e]||[]).map(i=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-sm font-medium",children:i.action}),a.jsx(C,{checked:p[`Telegram ${i.action}`]==="on",onCheckedChange:r=>w(`Telegram ${i.action}`,r),disabled:!n})]},i.id))})},e))]})]})]})]})})]})}export{ce as default};
