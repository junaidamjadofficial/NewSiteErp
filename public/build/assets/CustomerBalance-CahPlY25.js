import{j as e}from"./ui-ZHFf5B17.js";import{r as l}from"./vendor-CcMVubkO.js";import{X as C,x as v,a as w}from"./app-BBiA4mAE.js";import{B as N}from"./button-DYC7yMVq.js";import{C as D,c as b}from"./card-DHszHnbI.js";import{D as S}from"./date-picker-CVthJV3y.js";import{C as k}from"./checkbox-Cvtgzug2.js";import{a as B,f as r}from"./helpers-QYnGjXad.js";import{N as T}from"./no-records-found-C2RGIdAh.js";import{u as E}from"./useTranslation-CV4_gBnb.js";import{P as F}from"./printer-BDwaclJ1.js";import{F as P}from"./file-text-BmYvzZ5U.js";/* empty css            */import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";import"./react-datepicker-BHcKmBHW.js";import"./popover-fYI5j510.js";import"./calendar-DvmJ2XsD.js";import"./createLucideIcon-Dov4NOxw.js";import"./index-BYFX2qNQ.js";import"./check-DUlQPeVG.js";import"./plus-C1hmRCnY.js";function ae({financialYear:c}){var h,u;const{t:s}=E(),{auth:n}=C().props,[i,g]=l.useState((c==null?void 0:c.year_end_date)||""),[m,y]=l.useState(!1),[a,_]=l.useState(null),[d,x]=l.useState(!1),p=async()=>{x(!0);try{const t=await w.get(route("account.reports.customer-balance"),{params:{as_of_date:i,show_zero_balances:m}});_(t.data)}catch(t){console.error("Error:",t)}finally{x(!1)}};return l.useEffect(()=>{p()},[]),e.jsxs(D,{className:"shadow-sm",children:[e.jsx(b,{className:"p-6 border-b bg-gray-50/50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("As Of Date")}),e.jsx(S,{value:i,onChange:g,placeholder:s("Select date")})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mb-2",children:[e.jsx(k,{checked:m,onCheckedChange:y}),e.jsx("span",{className:"text-sm",children:s("Show Zero Balances")})]})}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(N,{onClick:p,disabled:d,size:"sm",children:s(d?"Loading...":"Generate")}),a&&((u=(h=n.user)==null?void 0:h.permissions)==null?void 0:u.includes("print-customer-balance"))&&e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>window.open(route("account.reports.customer-balance.print")+`?as_of_date=${i}&show_zero_balances=${m}&download=pdf`,"_blank"),className:"gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),s("Download PDF")]})]})]})}),e.jsx(b,{className:"p-0",children:a&&a.customers.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s("Customer Balance Summary")}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s("As of")," ",B(a.as_of_date)]}),e.jsxs("p",{className:"text-sm font-semibold mt-2",children:[s("Total Outstanding"),": ",r(a.total_balance)]})]}),e.jsx("div",{className:"overflow-y-auto max-h-[60vh]",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:s("Customer")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:s("Email")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:s("Total Invoiced")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:s("Total Returns & Credit Notes")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:s("Total Paid")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:s("Balance")})]})}),e.jsxs("tbody",{children:[a.customers.map((t,o)=>{var f,j;return e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:(j=(f=n.user)==null?void 0:f.permissions)!=null&&j.includes("view-customer-detail-report")?e.jsx(v,{href:route("account.reports.customer-detail",t.customer_id),className:"text-blue-600 hover:text-blue-700",children:t.customer_name}):t.customer_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.customer_email}),e.jsx("td",{className:"px-4 py-3 text-right",children:r(t.total_invoiced)}),e.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:r(t.total_returns)}),e.jsx("td",{className:"px-4 py-3 text-right",children:r(t.total_paid)}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold",children:r(t.balance)})]},o)}),e.jsxs("tr",{className:"bg-gray-200 font-bold border-t-4",children:[e.jsx("td",{colSpan:2,className:"px-4 py-4",children:s("Total")}),e.jsx("td",{className:"px-4 py-4 text-right",children:r(a.customers.reduce((t,o)=>t+o.total_invoiced,0))}),e.jsx("td",{className:"px-4 py-4 text-right text-red-600",children:r(a.customers.reduce((t,o)=>t+o.total_returns,0))}),e.jsx("td",{className:"px-4 py-4 text-right",children:r(a.customers.reduce((t,o)=>t+o.total_paid,0))}),e.jsx("td",{className:"px-4 py-4 text-right",children:r(a.total_balance)})]})]})]})})]}):e.jsx(T,{icon:P,title:s("Customer Balance Summary"),description:s("No customer balances found"),className:"h-auto py-12"})})]})}export{ae as default};
