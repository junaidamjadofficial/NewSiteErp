import{j as e}from"./ui-ZHFf5B17.js";import{r as c}from"./vendor-CcMVubkO.js";import{X as ge,A as h}from"./app-BBiA4mAE.js";import{C as je,a as Ne,b as fe,c as ve}from"./card-DHszHnbI.js";import{B as d}from"./button-DYC7yMVq.js";import{D as be,a as Ce,b as Se,c as ye,e as we}from"./dialog-BLwxprq_.js";import{T as le}from"./textarea-DxQ_BnuT.js";import{A as y,a as w,b as T}from"./avatar-BOBGUcwF.js";import{S as Te,a as _e,b as ke,c as Ae,d as v}from"./select-BEhl2QER.js";import{S as Pe}from"./search-input-BmfsW7ME.js";import{T as De,a as oe,b as ne,c as ie}from"./tooltip-C7wT1CW2.js";import{j as _,k as ze}from"./helpers-QYnGjXad.js";import{u as Ie}from"./useTranslation-CV4_gBnb.js";import{S as Ue}from"./square-pen-D0WnMiRU.js";import{T as Ee}from"./trash-2-CIuynBL1.js";import{C as Le}from"./chevron-left-CMBAh2v_.js";import{C as Me}from"./chevron-right-BtPraxo3.js";import{S as ce}from"./sticky-note-C2BipOAH.js";/* empty css            */import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./createLucideIcon-Dov4NOxw.js";import"./index-DaFL_H0m.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./input-DqOfVTcn.js";import"./chevron-down-Zr-tNTku.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";function gs({contract:g,setDeleteConfig:de}){var z,I,U,E,L,M,F,B,O,H,R,V,W,q,X,G;const{t:s}=Ie(),j=ge().props,{auth:t}=j,[me,p]=c.useState(!1),[b,C]=c.useState(null),[N,u]=c.useState(""),[S,k]=c.useState(""),[o,x]=c.useState(1),[m,xe]=c.useState(10),[f,A]=c.useState(""),[P,D]=c.useState(""),he=()=>{b?h.put(route("contract-notes.update",b),{note:N},{onSuccess:()=>{p(!1),u(""),C(null),h.reload()}}):h.post(route("contract-notes.store",g.id),{note:N},{onSuccess:()=>{p(!1),u(""),h.reload()}})},pe=()=>{h.post(route("contract-notes.store",g.id),{note:S},{onSuccess:()=>{k(""),h.reload()}})},ue=r=>{C(r.id),u(r.note),p(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsxs(Ne,{className:"flex flex-row items-center justify-between",children:[e.jsx(fe,{children:s("Notes")}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pe,{value:P,onChange:r=>D(r),onSearch:()=>{A(P),x(1)},onClear:()=>{A(""),D(""),x(1)},placeholder:s("Search notes..."),className:"w-64"}),e.jsxs(Te,{value:m.toString(),onValueChange:r=>{xe(Number(r)),x(1)},children:[e.jsx(_e,{className:"w-[120px]",children:e.jsx(ke,{})}),e.jsxs(Ae,{children:[e.jsx(v,{value:"5",children:s("5 per page")}),e.jsx(v,{value:"10",children:s("10 per page")}),e.jsx(v,{value:"20",children:s("20 per page")}),e.jsx(v,{value:"50",children:s("50 per page")})]})]})]})]}),e.jsxs(ve,{className:"p-4",children:[((I=(z=t.user)==null?void 0:z.permissions)==null?void 0:I.includes("create-contract-notes"))&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(y,{className:"h-8 w-8",children:[e.jsx(w,{src:(U=t.user)!=null&&U.avatar?_(t.user.avatar,j):(E=t.user)==null?void 0:E.profile_photo_url,alt:(L=t.user)==null?void 0:L.name}),e.jsx(T,{className:"text-xs bg-green-100 text-green-700",children:((B=(F=(M=t.user)==null?void 0:M.name)==null?void 0:F.charAt(0))==null?void 0:B.toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium mb-2 text-green-900",children:(O=t.user)==null?void 0:O.name}),e.jsx(le,{value:S,onChange:r=>k(r.target.value),placeholder:s("Write your note..."),rows:4,className:"resize-none mb-3 bg-white border-green-200 focus:border-green-300"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(d,{onClick:pe,disabled:!S.trim(),size:"sm",children:s("Send")})})]})]})}),(()=>{const r=g.notes?g.notes.filter(a=>{var n;return a.note.toLowerCase().includes(f.toLowerCase())||((n=a.user)==null?void 0:n.name.toLowerCase().includes(f.toLowerCase()))}):[],i={data:r.slice((o-1)*m,o*m),total:r.length,last_page:Math.ceil(r.length/m)};return i.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:i.data.map(a=>{var n,l,J,K,Q,Y,Z,$,ee,se,ae,te,re;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow group",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(y,{className:"h-8 w-8",children:[e.jsx(w,{src:(n=a.user)!=null&&n.avatar?_(a.user.avatar,j):(l=a.user)==null?void 0:l.profile_photo_url,alt:(J=a.user)==null?void 0:J.name}),e.jsx(T,{className:"text-xs bg-green-100 text-green-700",children:((Y=(Q=(K=a.user)==null?void 0:K.name)==null?void 0:Q.charAt(0))==null?void 0:Y.toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:(Z=a.user)==null?void 0:Z.name}),e.jsx("span",{className:"text-xs text-gray-500",children:ze(a.created_at)}),(a.user_id===(($=t.user)==null?void 0:$.id)||a.created_by===((ee=t.user)==null?void 0:ee.id))&&e.jsx(De,{children:e.jsxs("div",{className:"flex gap-1",children:[((ae=(se=t.user)==null?void 0:se.permissions)==null?void 0:ae.includes("edit-contract-notes"))&&e.jsxs(oe,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>ue(a),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:e.jsx(Ue,{className:"h-3 w-3"})})}),e.jsx(ie,{children:e.jsx("p",{children:s("Edit")})})]}),((re=(te=t.user)==null?void 0:te.permissions)==null?void 0:re.includes("delete-contract-notes"))&&e.jsxs(oe,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>de({type:"note",id:a.id,route:"contract-notes.destroy",message:s("Are you sure you want to delete this note?")}),className:"h-6 w-6 p-0 text-destructive hover:text-destructive",children:e.jsx(Ee,{className:"h-3 w-3"})})}),e.jsx(ie,{children:e.jsx("p",{children:s("Delete")})})]})]})})]}),e.jsx("div",{className:"mt-2 bg-gray-50 border border-gray-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-700",children:a.note})})]})]})},a.id)})}),r.length>m&&e.jsx("div",{className:"px-4 py-3 border-t bg-gray-50/30 mt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s("Showing")," ",e.jsx("span",{className:"font-medium text-foreground",children:(o-1)*m+1})," ",s("to")," ",e.jsx("span",{className:"font-medium text-foreground",children:Math.min(o*m,r.length)})," ",s("of")," ",e.jsx("span",{className:"font-medium text-foreground",children:r.length})," ",s("results")]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>x(a=>Math.max(1,a-1)),disabled:o===1,className:"h-8 px-3",children:[e.jsx(Le,{className:"h-4 w-4"}),s("Previous")]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,i.last_page)},(a,n)=>{let l;return i.last_page<=5||o<=3?l=n+1:o>=i.last_page-2?l=i.last_page-4+n:l=o-2+n,e.jsx(d,{variant:o===l?"default":"outline",size:"sm",onClick:()=>x(l),className:"h-8 w-8 p-0",children:l},l)})}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>x(a=>Math.min(i.last_page,a+1)),disabled:o===i.last_page,className:"h-8 px-3",children:[s("Next"),e.jsx(Me,{className:"h-4 w-4"})]})]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:s(f?"No notes found":"No notes yet")}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:s(f?"Try adjusting your search":"Be the first to add a note")})]})})()]})]}),b&&e.jsx(be,{open:me,onOpenChange:p,children:e.jsxs(Ce,{className:"sm:max-w-lg",children:[e.jsx(Se,{className:"pb-4",children:e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),s("Edit Note")]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(y,{className:"h-8 w-8 flex-shrink-0",children:[e.jsx(w,{src:(H=t.user)!=null&&H.avatar?_(t.user.avatar,j):(R=t.user)==null?void 0:R.profile_photo_url,alt:(V=t.user)==null?void 0:V.name}),e.jsx(T,{className:"text-xs bg-green-100 text-green-700",children:((X=(q=(W=t.user)==null?void 0:W.name)==null?void 0:q.charAt(0))==null?void 0:X.toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:(G=t.user)==null?void 0:G.name}),e.jsx(le,{value:N,onChange:r=>u(r.target.value),placeholder:s("Write your note..."),rows:4,className:"resize-none border-gray-200 focus:border-green-300 focus:ring-green-200"})]})]})}),e.jsxs(we,{className:"mt-6",children:[e.jsx(d,{variant:"outline",onClick:()=>{p(!1),u(""),C(null)},children:s("Cancel")}),e.jsx(d,{onClick:he,disabled:!N.trim(),children:s("Update")})]})]})})]})}export{gs as default};
