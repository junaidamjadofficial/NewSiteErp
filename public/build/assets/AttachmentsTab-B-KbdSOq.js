import{j as e}from"./ui-ZHFf5B17.js";import{r as _}from"./vendor-CcMVubkO.js";import{X as re,A as J}from"./app-BBiA4mAE.js";import{C as ie,a as te,b as le,c as ne}from"./card-DHszHnbI.js";import{B as t}from"./button-DYC7yMVq.js";import{D as ce,a as de,b as oe,c as me,e as he}from"./dialog-BLwxprq_.js";import{T as xe,a as pe,b as K,c as T,d as je,e as A}from"./table-DHznIK9t.js";import{A as ue,a as ge,b as fe}from"./avatar-BOBGUcwF.js";import{S as ve,a as Ne,b as we,c as be,d as z}from"./select-BEhl2QER.js";import{M as Ce}from"./MediaPicker-CztOgrDm.js";import{T as M,a as p,b as j,c as u}from"./tooltip-C7wT1CW2.js";import{j as g,a as ye,l as Q}from"./helpers-QYnGjXad.js";import{u as _e}from"./useTranslation-CV4_gBnb.js";import{L as Te}from"./list-BVwWsOhE.js";import{G as Ae}from"./grid-3x3-BHB0xGDK.js";import{U as ke}from"./upload-KhHqnUys.js";import{E as W}from"./eye-C8Kok_ez.js";import{D as Y}from"./download-DpWzK9fg.js";import{T as Z}from"./trash-2-CIuynBL1.js";import{C as Se}from"./chevron-left-CMBAh2v_.js";import{C as De}from"./chevron-right-BtPraxo3.js";import{P as Pe}from"./paperclip-C_mZqrNn.js";import{I as ze}from"./image-C8M1mNs8.js";import{F as $}from"./file-BD5h_kEE.js";/* empty css            */import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./createLucideIcon-Dov4NOxw.js";import"./index-DaFL_H0m.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./input-DqOfVTcn.js";import"./chevron-down-Zr-tNTku.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./label-DbqhUtKI.js";import"./badge-CV60sqBJ.js";import"./plus-C1hmRCnY.js";function Ns({contract:c,setDeleteConfig:U}){var B,E;const{t:a}=_e(),o=re().props,{auth:l}=o,[ee,k]=_.useState(!1),[S,I]=_.useState([]),[F,V]=_.useState("list"),[n,D]=_.useState(1),[h,se]=_.useState(18),P=s=>{var m;const i=(m=s.split(".").pop())==null?void 0:m.toLowerCase(),r=["jpg","jpeg","png","gif","webp","svg"],x=["pdf"];return r.includes(i||"")?e.jsx(ze,{className:"h-4 w-4"}):x.includes(i||"")?e.jsx($,{className:"h-4 w-4"}):e.jsx($,{className:"h-4 w-4"})},L=s=>{var r;const i=(r=s.split(".").pop())==null?void 0:r.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(i||"")},d=c.attachments?{data:c.attachments.slice((n-1)*h,n*h),total:c.attachments.length,last_page:Math.ceil(c.attachments.length/h)}:{data:[],last_page:1},ae=()=>{S.length>0&&J.post(route("contract-attachments.store",c.id),{media_paths:S},{onSuccess:()=>{k(!1),I([]),J.reload()}})};return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsxs(te,{className:"flex flex-row items-center justify-between",children:[e.jsx(le,{children:a("Attachments")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex border rounded-md",children:[e.jsx(t,{size:"sm",variant:F==="list"?"default":"ghost",onClick:()=>V("list"),className:"rounded-r-none px-2 h-9",children:e.jsx(Te,{className:"h-3 w-3"})}),e.jsx(t,{size:"sm",variant:F==="grid"?"default":"ghost",onClick:()=>V("grid"),className:"rounded-l-none px-2 h-9",children:e.jsx(Ae,{className:"h-3 w-3"})})]}),e.jsxs(ve,{value:h.toString(),onValueChange:s=>{se(Number(s)),D(1)},children:[e.jsx(Ne,{className:"w-[120px] h-9",children:e.jsx(we,{})}),e.jsxs(be,{children:[e.jsx(z,{value:"18",children:a("18 per page")}),e.jsx(z,{value:"36",children:a("36 per page")}),e.jsx(z,{value:"54",children:a("54 per page")}),e.jsx(z,{value:"100",children:a("100 per page")})]})]}),((E=(B=l.user)==null?void 0:B.permissions)==null?void 0:E.includes("create-contract-attachments"))&&e.jsx(M,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx(t,{size:"sm",onClick:()=>k(!0),className:"h-9",children:e.jsx(ke,{className:"h-4 w-4 "})})}),e.jsx(u,{children:e.jsx("p",{children:a("Upload")})})]})})]})]}),e.jsx(ne,{className:"p-0",children:d.data.length>0?e.jsxs(e.Fragment,{children:[F==="list"?e.jsxs(xe,{children:[e.jsx(pe,{children:e.jsxs(K,{children:[e.jsx(T,{className:"w-16",children:a("Preview")}),e.jsx(T,{children:a("File Name")}),e.jsx(T,{children:a("Uploaded By")}),e.jsx(T,{children:a("Date")}),e.jsx(T,{className:"w-20",children:a("Actions")})]})}),e.jsx(je,{children:d.data.map(s=>{var i,r,x,m,f,v,N,w,b,C,y;return e.jsxs(K,{children:[e.jsx(A,{children:(r=(i=l.user)==null?void 0:i.permissions)!=null&&r.includes("view-contracts")?L(s.file_name)?e.jsx("img",{src:g(s.file_path,o),alt:s.file_name,className:"w-10 h-10 object-cover rounded border"}):e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded border flex items-center justify-center",children:P(s.file_name)}):e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded border flex items-center justify-center",children:P(s.file_name)})}),e.jsx(A,{className:"font-medium",children:s.file_name}),e.jsx(A,{children:((x=s.uploader)==null?void 0:x.name)||"-"}),e.jsx(A,{children:ye(s.created_at)}),e.jsx(A,{children:e.jsx(M,{children:e.jsxs("div",{className:"flex gap-1",children:[((f=(m=l.user)==null?void 0:m.permissions)==null?void 0:f.includes("view-contracts"))&&e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>window.open(g(s.file_path,o),"_blank"),className:"text-blue-600 hover:text-blue-700",children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:a("View")})})]}),((N=(v=l.user)==null?void 0:v.permissions)==null?void 0:N.includes("view-contracts"))&&e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>Q(g(s.file_path,o)),className:"text-green-600 hover:text-green-700",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:a("Download")})})]}),((b=(w=l.user)==null?void 0:w.permissions)==null?void 0:b.includes("delete-contract-attachments"))&&(s.uploaded_by===((C=l.user)==null?void 0:C.id)||s.created_by===((y=l.user)==null?void 0:y.id))&&e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>U({type:"attachment",id:s.id,route:"contract-attachments.destroy",message:a("Are you sure you want to delete this attachment?")}),className:"text-destructive hover:text-destructive",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:a("Delete")})})]})]})})})]},s.id)})})]}):e.jsx("div",{className:"grid grid-cols-6 gap-4 p-4",children:d.data.map(s=>{var i,r,x,m,f,v,N,w,b,C,y,H,O,R,G,q,X;return e.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-all duration-200",children:[e.jsx("div",{className:"aspect-square bg-gray-50 flex items-center justify-center overflow-hidden",children:(r=(i=l.user)==null?void 0:i.permissions)!=null&&r.includes("view-contracts")?L(s.file_name)?e.jsx("img",{src:g(s.file_path,o),alt:s.file_name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"text-gray-400",children:P(s.file_name)}):e.jsx("div",{className:"text-gray-400",children:P(s.file_name)})}),e.jsx("div",{className:"p-3 border-t bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ue,{className:"h-6 w-6",children:[e.jsx(ge,{src:(x=s.uploader)!=null&&x.avatar?g(s.uploader.avatar,o):(m=s.uploader)==null?void 0:m.profile_photo_url,alt:(f=s.uploader)==null?void 0:f.name}),e.jsx(fe,{className:"text-xs bg-blue-100 text-blue-700",children:((w=(N=(v=s.uploader)==null?void 0:v.name)==null?void 0:N.charAt(0))==null?void 0:w.toUpperCase())||"U"})]}),e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:((b=s.uploader)==null?void 0:b.name)||a("Unknown")})]}),e.jsx(M,{children:e.jsxs("div",{className:"flex gap-1",children:[((y=(C=l.user)==null?void 0:C.permissions)==null?void 0:y.includes("view-contracts"))&&e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>window.open(g(s.file_path,o),"_blank"),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:e.jsx(W,{className:"h-3 w-3"})})}),e.jsx(u,{children:e.jsx("p",{children:a("View")})})]}),((O=(H=l.user)==null?void 0:H.permissions)==null?void 0:O.includes("view-contracts"))&&e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>Q(g(s.file_path,o)),className:"h-6 w-6 p-0 text-green-600 hover:text-green-700",children:e.jsx(Y,{className:"h-3 w-3"})})}),e.jsx(u,{children:e.jsx("p",{children:a("Download")})})]}),((G=(R=l.user)==null?void 0:R.permissions)==null?void 0:G.includes("delete-contract-attachments"))&&(s.uploaded_by===((q=l.user)==null?void 0:q.id)||s.created_by===((X=l.user)==null?void 0:X.id))&&e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>U({type:"attachment",id:s.id,route:"contract-attachments.destroy",message:a("Are you sure you want to delete this attachment?")}),className:"h-6 w-6 p-0 text-destructive hover:text-destructive",children:e.jsx(Z,{className:"h-3 w-3"})})}),e.jsx(u,{children:e.jsx("p",{children:a("Delete")})})]})]})})]})})]},s.id)})}),c.attachments&&c.attachments.length>h&&e.jsx("div",{className:"px-4 py-3 border-t bg-gray-50/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[a("Showing")," ",e.jsx("span",{className:"font-medium text-foreground",children:(n-1)*h+1})," ",a("to")," ",e.jsx("span",{className:"font-medium text-foreground",children:Math.min(n*h,c.attachments.length)})," ",a("of")," ",e.jsx("span",{className:"font-medium text-foreground",children:c.attachments.length})," ",a("results")]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>D(s=>Math.max(1,s-1)),disabled:n===1,className:"h-8 px-3",children:[e.jsx(Se,{className:"h-4 w-4"}),a("Previous")]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,d.last_page)},(s,i)=>{let r;return d.last_page<=5||n<=3?r=i+1:n>=d.last_page-2?r=d.last_page-4+i:r=n-2+i,e.jsx(t,{variant:n===r?"default":"outline",size:"sm",onClick:()=>D(r),className:"h-8 w-8 p-0",children:r},r)})}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>D(s=>Math.min(d.last_page,s+1)),disabled:n===d.last_page,className:"h-8 px-3",children:[a("Next"),e.jsx(De,{className:"h-4 w-4"})]})]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Pe,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:a("No attachments found")})]})})]}),e.jsx(ce,{open:ee,onOpenChange:k,children:e.jsxs(de,{children:[e.jsx(oe,{className:"mb-4",children:e.jsx(me,{children:a("Add Attachments")})}),e.jsx("div",{className:"space-y-4",children:e.jsx(Ce,{multiple:!0,value:S,onChange:s=>I(s),showPreview:!0,placeholder:a("Select files to attach...")})}),e.jsxs(he,{className:"mt-4",children:[e.jsx(t,{variant:"outline",onClick:()=>k(!1),children:a("Cancel")}),e.jsx(t,{onClick:ae,disabled:S.length===0,children:a("Upload")})]})]})})]})}export{Ns as default};
