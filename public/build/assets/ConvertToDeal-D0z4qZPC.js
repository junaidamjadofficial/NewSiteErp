import{j as e}from"./ui-ZHFf5B17.js";import{r as d}from"./vendor-CcMVubkO.js";import{x as S,A as T}from"./app-BBiA4mAE.js";import{B as h}from"./button-DYC7yMVq.js";import{D as F,f as A,a as I,b as P,c as R}from"./dialog-BLwxprq_.js";import{T as g,a as C,b as _,c as v}from"./tooltip-C7wT1CW2.js";import{I as m}from"./input-DqOfVTcn.js";import{L as t}from"./label-DbqhUtKI.js";import{C as q}from"./checkbox-Cvtgzug2.js";import{R as L,a as k}from"./radio-group-Bg6nc_Xb.js";import{S as V,a as z,b as B,c as G,d as O}from"./select-BEhl2QER.js";import{I as c}from"./input-error-DuIbBMgZ.js";import{u as $}from"./useTranslation-CV4_gBnb.js";import{A as y}from"./arrow-right-left-B2Yy1Hqs.js";/* empty css            */import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";import"./x-DVK_F_Gh.js";import"./createLucideIcon-Dov4NOxw.js";import"./index-BZAHB8Ku.js";import"./index-BYFX2qNQ.js";import"./check-DUlQPeVG.js";import"./circle-bmoNtd-e.js";import"./index-BdQq_4o_.js";import"./chevron-down-Zr-tNTku.js";import"./search-Chs14P_a.js";function fe({lead:o,deal:x}){const{t:i}=$(),[w,p]=d.useState(!1),[N,u]=d.useState([]),[n,f]=d.useState({}),[l,a]=d.useState({name:o.subject||o.name,price:"0",client_check:"new",clients:"",client_name:o.name,client_email:o.email,client_password:"",is_transfer:["products","sources","files","discussion","notes","calls","emails"]});d.useEffect(()=>{l.client_check==="exist"&&fetch(route("lead.leads.existing-clients")).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>u(Array.isArray(s)?s:[])).catch(s=>{u([])})},[l.client_check]);const b=s=>{s.preventDefault(),T.post(route("lead.leads.convert-to-deal",o.id),l,{onSuccess:()=>{p(!1),f({})},onError:r=>{f(r)}})},D=(s,r)=>{a(j=>({...j,is_transfer:r?[...j.is_transfer,s]:j.is_transfer.filter(E=>E!==s)}))};return x?e.jsx(g,{children:e.jsxs(C,{children:[e.jsx(_,{asChild:!0,children:e.jsx(S,{href:x.is_active?route("lead.deals.show",x.id):"#",children:e.jsx(h,{size:"sm",children:e.jsx(y,{className:"h-4 w-4"})})})}),e.jsx(v,{children:e.jsx("p",{children:i("Already Converted To Deal")})})]})}):e.jsxs(F,{open:w,onOpenChange:p,children:[e.jsx(g,{children:e.jsxs(C,{children:[e.jsx(_,{asChild:!0,children:e.jsx(A,{asChild:!0,children:e.jsx(h,{size:"sm",children:e.jsx(y,{className:"h-4 w-4"})})})}),e.jsx(v,{children:e.jsx("p",{children:i("Convert to Deal")})})]})}),e.jsxs(I,{className:"max-w-2xl",children:[e.jsx(P,{children:e.jsx(R,{children:i("Convert Lead to Deal")})}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"name",children:i("Deal Name")}),e.jsx(m,{id:"name",value:l.name,onChange:s=>a(r=>({...r,name:s.target.value})),placeholder:i("Enter Name"),required:!0}),e.jsx(c,{message:n.name})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"price",children:i("Price")}),e.jsx(m,{id:"price",type:"number",min:"0",value:l.price,onChange:s=>a(r=>({...r,price:s.target.value}))}),e.jsx(c,{message:n.price})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(t,{children:i("Client Type")}),e.jsxs(L,{value:l.client_check,onValueChange:s=>a(r=>({...r,client_check:s})),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:"new",id:"new_client"}),e.jsx(t,{htmlFor:"new_client",children:i("New Client")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:"exist",id:"existing_client"}),e.jsx(t,{htmlFor:"existing_client",children:i("Existing Client")})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.client_check==="exist"?e.jsxs("div",{children:[e.jsx(t,{htmlFor:"clients",children:i("Client")}),e.jsxs(V,{value:l.clients,onValueChange:s=>a(r=>({...r,clients:s})),children:[e.jsx(z,{children:e.jsx(B,{placeholder:i("Select Client")})}),e.jsx(G,{children:N.map(s=>e.jsxs(O,{value:s.email,children:[s.name," (",s.email,")"]},s.id))})]}),e.jsx(c,{message:n.clients})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"client_name",children:i("Client Name")}),e.jsx(m,{id:"client_name",onChange:s=>a(r=>({...r,client_name:s.target.value})),placeholder:i("Enter Client Name"),required:!0}),e.jsx(c,{message:n.client_name})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"client_email",children:i("Client Email")}),e.jsx(m,{id:"client_email",type:"email",value:l.client_email,onChange:s=>a(r=>({...r,client_email:s.target.value})),placeholder:i("Enter Client Email"),required:!0}),e.jsx(c,{message:n.client_email})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"client_password",children:i("Client Password")}),e.jsx(m,{id:"client_password",type:"password",value:l.client_password,onChange:s=>a(r=>({...r,client_password:s.target.value})),placeholder:i("Enter Client Password"),required:!0}),e.jsx(c,{message:n.client_password})]})]})}),e.jsxs("div",{children:[e.jsx(t,{className:"font-bold text-dark",children:i("Copy To")}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mt-2",children:[{key:"products",label:"Products"},{key:"sources",label:"Sources"},{key:"files",label:"Files"},{key:"discussion",label:"Discussion"},{key:"notes",label:"Notes"},{key:"calls",label:"Calls"},{key:"emails",label:"Emails"}].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:`is_transfer_${s.key}`,checked:l.is_transfer.includes(s.key),onCheckedChange:r=>D(s.key,r)}),e.jsx(t,{htmlFor:`is_transfer_${s.key}`,className:"text-sm",children:i(s.label)})]},s.key))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>p(!1),children:i("Cancel")}),e.jsx(h,{type:"submit",children:i("Convert")})]})]})]})]})}export{fe as default};
