import{j as e}from"./ui-ZHFf5B17.js";import{r as o}from"./vendor-CcMVubkO.js";import{A as v}from"./app-BBiA4mAE.js";import{D as S}from"./data-table--afTq2As.js";import{B as c}from"./button-DYC7yMVq.js";import{D as w,a as T,b as A,c as k}from"./dialog-BLwxprq_.js";import{L as O}from"./label-DbqhUtKI.js";import{M as I}from"./multi-select-enhanced-C0hF2-Yw.js";import{T as M,a as E,b as B,c as R}from"./tooltip-C7wT1CW2.js";import{C as _}from"./confirmation-dialog-mYyCtWPl.js";import{N as F}from"./no-records-found-C2RGIdAh.js";import{j as L}from"./helpers-QYnGjXad.js";import{u as P}from"./useTranslation-CV4_gBnb.js";import{U as z}from"./users-OzPx1l-a.js";import{T as G}from"./trash-2-CIuynBL1.js";/* empty css            */import"./card-DHszHnbI.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./input-DqOfVTcn.js";import"./table-DHznIK9t.js";import"./search-Chs14P_a.js";import"./createLucideIcon-Dov4NOxw.js";import"./chevron-left-CMBAh2v_.js";import"./chevron-right-BtPraxo3.js";import"./arrow-up-down-D4TAtYCt.js";import"./arrow-up-BLTFDVcR.js";import"./index-BMyiKApA.js";import"./x-DVK_F_Gh.js";import"./popover-fYI5j510.js";import"./badge-CV60sqBJ.js";import"./chevron-down-Zr-tNTku.js";import"./check-DUlQPeVG.js";import"./index-BZAHB8Ku.js";import"./plus-C1hmRCnY.js";function Ne({lead:i,onRegisterAddHandler:d}){o.useEffect(()=>{d(()=>h())},[d]);const{t:r}=P(),[g,l]=o.useState(!1),[U,b]=o.useState([]),[n,p]=o.useState([]),[m,u]=o.useState({isOpen:!1,userId:null,message:""}),y=async()=>{try{const t=await(await fetch(route("lead.leads.available-users",i.id))).json();b(t.map(s=>({value:s.id.toString(),label:s.name})))}catch{}},D=()=>{n.length!==0&&v.post(route("lead.leads.assign-users",i.id),{user_ids:n.map(a=>parseInt(a))},{onSuccess:()=>{l(!1),p([])}})},h=()=>{y(),l(!0)},N=a=>{u({isOpen:!0,userId:a,message:r("Are you sure you want to remove this user?")})},f=()=>{u({isOpen:!1,userId:null,message:""})},C=()=>{m.userId&&(v.delete(route("lead.leads.remove-user",{lead:i.id,user:m.userId})),f())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[75vh] rounded-none w-full",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(S,{data:i.user_leads||[],columns:[{key:"user.avatar",header:r("Avatar"),render:(a,t)=>{var x,j;const s=t.user;return e.jsx("div",{className:"h-8 w-8 rounded-full border-2 border-background overflow-hidden",children:s!=null&&s.avatar?e.jsx("img",{src:L(s.avatar),alt:s.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-primary/10 flex items-center justify-center text-sm font-medium",children:((j=(x=s==null?void 0:s.name)==null?void 0:x.charAt(0))==null?void 0:j.toUpperCase())||"U"})})}},{key:"user.name",header:r("User Name"),render:(a,t)=>{var s;return((s=t.user)==null?void 0:s.name)||"-"}},{key:"actions",header:r("Action"),render:(a,t)=>e.jsx("div",{className:"flex gap-1",children:e.jsx(M,{children:e.jsxs(E,{delayDuration:0,children:[e.jsx(B,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{var s;N((s=t.user)==null?void 0:s.id)},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsx(R,{children:e.jsx("p",{children:r("Delete User")})})]})})})}],className:"rounded-none",emptyState:e.jsx(F,{icon:z,title:r("No Users added"),description:r("Get started by adding users to this lead."),onCreateClick:()=>h(),createButtonText:r("Add Users"),className:"h-auto"})})})}),e.jsx(w,{open:g,onOpenChange:l,children:e.jsxs(T,{className:"max-w-md",children:[e.jsx(A,{children:e.jsx(k,{children:r("Add Users")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(O,{children:r("Select Users")}),e.jsx(I,{options:U,value:n,onValueChange:p,placeholder:r("Select users"),searchable:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>l(!1),children:r("Cancel")}),e.jsx(c,{onClick:D,disabled:n.length===0,children:r("Save")})]})]})]})}),e.jsx(_,{open:m.isOpen,onOpenChange:f,title:r("Remove User"),message:m.message,confirmText:r("Remove"),onConfirm:C,variant:"destructive"})]})}export{Ne as default};
