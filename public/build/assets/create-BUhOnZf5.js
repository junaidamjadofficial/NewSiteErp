import{j as e}from"./ui-ZHFf5B17.js";import{a as q,b as D,c as T}from"./dialog-BLwxprq_.js";import{X as F,G as I}from"./app-BBiA4mAE.js";import{B as w}from"./button-DYC7yMVq.js";import{I as N}from"./input-DqOfVTcn.js";import{L as i}from"./label-DbqhUtKI.js";import{S as m,a as u,b as c,c as h,d as p}from"./select-BEhl2QER.js";import{D as V}from"./date-picker-CVthJV3y.js";import{I as n}from"./input-error-DuIbBMgZ.js";import{u as W}from"./useTranslation-CV4_gBnb.js";import"./vendor-CcMVubkO.js";import"./utils-DrcJ8Itn.js";import"./utils-B-dksMZM.js";import"./x-DVK_F_Gh.js";import"./createLucideIcon-Dov4NOxw.js";/* empty css            */import"./index-BMyiKApA.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./chevron-down-Zr-tNTku.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./react-datepicker-BHcKmBHW.js";import"./popover-fYI5j510.js";import"./calendar-DvmJ2XsD.js";function ne({onSuccess:x}){var v;const{t}=W(),{warehouses:j,products:B,warehouseStocks:d}=F().props,{data:a,setData:o,post:S,processing:f,errors:s}=I({from_warehouse:"",to_warehouse:"",product_id:"",quantity:"",date:new Date().toISOString().split("T")[0]}),b=j.filter(r=>r.id.toString()!==a.from_warehouse),g=((v=d==null?void 0:d.filter(r=>r.warehouse_id.toString()===a.from_warehouse&&Number(r.quantity)>0))==null?void 0:v.map(r=>({...r.product,available_quantity:r.quantity})))||[],y=r=>{o({...a,from_warehouse:r,to_warehouse:a.to_warehouse===r?"":a.to_warehouse,product_id:"",quantity:""})},l=g.find(r=>r.id.toString()===a.product_id),_=(l==null?void 0:l.available_quantity)||0,C=r=>{r.preventDefault(),S(route("transfers.store"),{onSuccess:()=>{x()}})};return e.jsxs(q,{children:[e.jsx(D,{children:e.jsx(T,{children:t("Create Transfer")})}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"from_warehouse",children:t("From Warehouse")}),e.jsxs(m,{value:a.from_warehouse,onValueChange:y,children:[e.jsx(u,{children:e.jsx(c,{placeholder:t("Select warehouse")})}),e.jsx(h,{children:j.map(r=>e.jsx(p,{value:r.id.toString(),children:r.name},r.id))})]}),e.jsx(n,{message:s.from_warehouse})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"to_warehouse",children:t("To Warehouse")}),e.jsxs(m,{value:a.to_warehouse,onValueChange:r=>o("to_warehouse",r),disabled:!a.from_warehouse,children:[e.jsx(u,{children:e.jsx(c,{placeholder:a.from_warehouse?t("Select warehouse"):t("Select from warehouse first")})}),e.jsx(h,{children:b.map(r=>e.jsx(p,{value:r.id.toString(),children:r.name},r.id))})]}),e.jsx(n,{message:s.to_warehouse})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"product_id",children:t("Product")}),e.jsxs(m,{value:a.product_id,onValueChange:r=>o("product_id",r),disabled:!a.from_warehouse,children:[e.jsx(u,{children:e.jsx(c,{placeholder:a.from_warehouse?t("Select product"):t("Select from warehouse first")})}),e.jsx(h,{children:g.map(r=>e.jsx(p,{value:r.id.toString(),children:r.name},r.id))})]}),e.jsx(n,{message:s.product_id})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"quantity",children:t("Quantity")}),e.jsx(N,{id:"quantity",type:"number",step:"1",min:"1",max:_,value:a.quantity,onChange:r=>o("quantity",r.target.value),placeholder:l?`Available: ${_}`:t("Select product first"),disabled:!a.product_id,required:!0}),e.jsx(n,{message:s.quantity})]}),e.jsxs("div",{children:[e.jsx(i,{children:t("Date")}),e.jsx(V,{value:a.date,onChange:r=>o("date",r),placeholder:t("Select transfer date")}),e.jsx(n,{message:s.date})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(w,{type:"button",variant:"outline",onClick:x,children:t("Cancel")}),e.jsx(w,{type:"submit",disabled:f,children:t(f?"Creating...":"Create")})]})]})]})}export{ne as default};
