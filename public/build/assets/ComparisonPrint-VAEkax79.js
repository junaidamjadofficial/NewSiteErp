import{j as t}from"./ui-ZHFf5B17.js";import{r as A}from"./vendor-CcMVubkO.js";import{X as E,S as v}from"./app-BBiA4mAE.js";import{a as D}from"./html2pdf-Dais6JZR.js";import{b as i,a as p,f as r}from"./helpers-QYnGjXad.js";import{u as I}from"./useTranslation-CV4_gBnb.js";/* empty css            */function B(){const{t:o}=I(),{comparison:b}=E().props,[S,w]=A.useState(!1),s=b.current_period||b.currentPeriod,e=b.previous_period||b.previousPeriod;A.useEffect(()=>{new URLSearchParams(window.location.search).get("download")==="pdf"&&T()},[]);const T=async()=>{w(!0);const n=document.querySelector(".report-container");if(n){const a={margin:.25,filename:"balance-sheet-comparison.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"a4",orientation:"landscape"}};try{await D().set(a).from(n).save(),setTimeout(()=>window.close(),1e3)}catch(l){console.error("PDF generation failed:",l)}}w(!1)},j=((s==null?void 0:s.items)||[]).reduce((n,a)=>{var l;return(l=a==null?void 0:a.account)!=null&&l.account_code&&(n[a.account.account_code]=a),n},{}),u=((e==null?void 0:e.items)||[]).reduce((n,a)=>{var l;return(l=a==null?void 0:a.account)!=null&&l.account_code&&(n[a.account.account_code]=a),n},{}),k=Array.from(new Set([...Object.keys(j),...Object.keys(u)])).sort(),c=(n,a)=>(n||[]).filter(l=>l.section_type===a).reduce((l,x)=>l+(parseFloat(x.amount)||0),0),g=(n,a)=>{const l=k.filter(m=>{const d=j[m]||u[m];return(d==null?void 0:d.section_type)===n});if(l.length===0)return null;let x=0,y=0;return t.jsxs("div",{className:"mb-6 page-break-inside-avoid",children:[t.jsx("h3",{className:"text-base font-bold border-b-2 border-gray-400 pb-1 mb-2",children:a}),t.jsx("table",{className:"w-full border-collapse",children:t.jsxs("tbody",{children:[l.map(m=>{const d=j[m],h=u[m],f=parseFloat(d==null?void 0:d.amount)||0,N=parseFloat(h==null?void 0:h.amount)||0,_=f-N;return x+=f,y+=N,t.jsxs("tr",{className:"border-b border-gray-200 page-break-inside-avoid",children:[t.jsxs("td",{className:"py-2 px-2 text-sm",style:{width:"40%"},children:[(d==null?void 0:d.account.account_name)||(h==null?void 0:h.account.account_name),t.jsxs("span",{className:"text-xs text-gray-600 ml-1",children:["(",m,")"]})]}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",style:{width:"20%"},children:r(f)}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",style:{width:"20%"},children:r(N)}),t.jsxs("td",{className:"py-2 px-2 text-sm text-right tabular-nums font-medium",style:{width:"20%"},children:[_>=0?"+":"",r(_)]})]},m)}),t.jsxs("tr",{className:"border-t-2 border-black font-bold",children:[t.jsxs("td",{className:"py-2 px-2 text-sm",children:["TOTAL ",a.toUpperCase()]}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",children:r(x)}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",children:r(y)}),t.jsxs("td",{className:"py-2 px-2 text-sm text-right tabular-nums",children:[x-y>=0?"+":"",r(x-y)]})]})]})})]})};return t.jsxs("div",{className:"min-h-screen bg-white",children:[t.jsx(v,{title:o("Balance Sheet Comparison")}),S&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsx("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t.jsx("p",{className:"text-lg font-semibold text-gray-700",children:o("Generating PDF...")})]})})}),t.jsxs("div",{className:"report-container bg-white max-w-6xl mx-auto p-8",children:[t.jsx("div",{className:"border-b-2 border-gray-800 pb-6 mb-8",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:i("company_name")||"YOUR COMPANY"}),t.jsxs("div",{className:"text-sm text-gray-600 space-y-0.5",children:[i("company_address")&&t.jsx("p",{children:i("company_address")}),(i("company_city")||i("company_state")||i("company_zipcode"))&&t.jsxs("p",{children:[i("company_city"),i("company_state")&&`, ${i("company_state")}`," ",i("company_zipcode")]}),i("company_country")&&t.jsx("p",{children:i("company_country")})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:o("COMPARATIVE BALANCE SHEET")}),t.jsxs("p",{className:"text-sm text-gray-600",children:[p(s==null?void 0:s.balance_sheet_date)," vs ",p(e==null?void 0:e.balance_sheet_date)]})]})]})}),t.jsx("table",{className:"w-full border-collapse mb-6",children:t.jsx("thead",{children:t.jsxs("tr",{className:"border-b-2 border-black",children:[t.jsx("th",{className:"text-left py-2 px-2 text-sm font-semibold",style:{width:"40%"},children:o("Account")}),t.jsx("th",{className:"text-right py-2 px-2 text-sm font-semibold",style:{width:"20%"},children:p(s==null?void 0:s.balance_sheet_date)}),t.jsx("th",{className:"text-right py-2 px-2 text-sm font-semibold",style:{width:"20%"},children:p(e==null?void 0:e.balance_sheet_date)}),t.jsx("th",{className:"text-right py-2 px-2 text-sm font-semibold",style:{width:"20%"},children:o("Change")})]})})}),g("assets",o("ASSETS")),g("liabilities",o("LIABILITIES")),g("equity",o("EQUITY")),t.jsx("div",{className:"mt-6 pt-4 border-t-4 border-black",children:t.jsx("table",{className:"w-full border-collapse",children:t.jsxs("tbody",{children:[t.jsxs("tr",{className:"font-bold",children:[t.jsx("td",{className:"py-2 px-2 text-sm",style:{width:"40%"},children:"TOTAL ASSETS"}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",style:{width:"20%"},children:r(c(s==null?void 0:s.items,"assets"))}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",style:{width:"20%"},children:r(c(e==null?void 0:e.items,"assets"))}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",style:{width:"20%"},children:r(c(s==null?void 0:s.items,"assets")-c(e==null?void 0:e.items,"assets"))})]}),t.jsxs("tr",{className:"font-bold border-t",children:[t.jsx("td",{className:"py-2 px-2 text-sm",children:"TOTAL LIABILITIES AND EQUITY"}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",children:r(c(s==null?void 0:s.items,"liabilities")+c(s==null?void 0:s.items,"equity"))}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",children:r(c(e==null?void 0:e.items,"liabilities")+c(e==null?void 0:e.items,"equity"))}),t.jsx("td",{className:"py-2 px-2 text-sm text-right tabular-nums",children:r(c(s==null?void 0:s.items,"liabilities")+c(s==null?void 0:s.items,"equity")-(c(e==null?void 0:e.items,"liabilities")+c(e==null?void 0:e.items,"equity")))})]})]})})}),t.jsx("div",{className:"mt-8 pt-4 border-t text-center text-xs text-gray-600",children:t.jsxs("p",{children:[o("Generated on")," ",p(new Date().toISOString())]})})]}),t.jsx("style",{children:`
                body {
                    -webkit-print-color-adjust: exact;
                    color-adjust: exact;
                    font-family: Arial, sans-serif;
                }

                @page {
                    margin: 0.25in;
                    size: A4 landscape;
                }

                .report-container {
                    max-width: 100%;
                    margin: 0;
                    box-shadow: none;
                }

                .page-break-inside-avoid {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }

                @media print {
                    body {
                        background: white;
                    }

                    .report-container {
                        box-shadow: none;
                    }

                    .page-break-inside-avoid {
                        page-break-inside: avoid;
                        break-inside: avoid;
                    }
                }
            `})]})}export{B as default};
