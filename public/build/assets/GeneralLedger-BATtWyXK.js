import{j as e}from"./ui-ZHFf5B17.js";import{r as l}from"./vendor-CcMVubkO.js";import{X as T,a as v}from"./app-BBiA4mAE.js";import{B as u}from"./button-DYC7yMVq.js";import{C as L,c as g}from"./card-DHszHnbI.js";import{S as R,a as z,b as G,c as I,d as $}from"./select-BEhl2QER.js";import{D as C}from"./date-picker-CVthJV3y.js";import{a as j,f as m}from"./helpers-QYnGjXad.js";import{N as w}from"./no-records-found-C2RGIdAh.js";import{u as V}from"./useTranslation-CV4_gBnb.js";import{P as O}from"./printer-BDwaclJ1.js";import{F as k}from"./file-text-BmYvzZ5U.js";/* empty css            */import"./index-BMyiKApA.js";import"./utils-B-dksMZM.js";import"./utils-DrcJ8Itn.js";import"./index-BdQq_4o_.js";import"./index-BYFX2qNQ.js";import"./index-BZAHB8Ku.js";import"./input-DqOfVTcn.js";import"./chevron-down-Zr-tNTku.js";import"./createLucideIcon-Dov4NOxw.js";import"./search-Chs14P_a.js";import"./check-DUlQPeVG.js";import"./react-datepicker-BHcKmBHW.js";import"./popover-fYI5j510.js";import"./calendar-DvmJ2XsD.js";import"./plus-C1hmRCnY.js";function je({financialYear:a}){var _,D;const{t}=V(),{auth:A}=T().props,[c,i]=l.useState(""),[d,b]=l.useState((a==null?void 0:a.year_start_date)||""),[n,y]=l.useState((a==null?void 0:a.year_end_date)||""),[F,N]=l.useState([]),[r,x]=l.useState(null),[p,h]=l.useState(null),[f,S]=l.useState(!1),B=async()=>{if(c){S(!0);try{const s=await v.get(route("double-entry.reports.general-ledger"),{params:{account_id:c,from_date:d,to_date:n}});x(s.data.data),N(s.data.accounts),h(s.data.selectedAccount)}catch(s){console.error("Error fetching general ledger:",s)}finally{S(!1)}}};l.useEffect(()=>{(async()=>{try{const o=await v.get(route("double-entry.reports.general-ledger"));N(o.data.accounts),o.data.data&&x(o.data.data),o.data.selectedAccount&&(i(o.data.selectedAccount.id.toString()),h(o.data.selectedAccount))}catch(o){console.error("Error loading data:",o)}})()},[]);const E=()=>{const s=route("double-entry.reports.general-ledger.print")+`?account_id=${c}&from_date=${d}&to_date=${n}&download=pdf`;window.open(s,"_blank")},P=()=>{i(""),b((a==null?void 0:a.year_start_date)||""),y((a==null?void 0:a.year_end_date)||""),x(null),h(null)};return e.jsxs(L,{className:"shadow-sm",children:[e.jsx(g,{className:"p-6 border-b bg-gray-50/50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("Account")}),e.jsxs(R,{value:c,onValueChange:i,children:[e.jsx(z,{children:e.jsx(G,{placeholder:t("Select Account")})}),e.jsx(I,{searchable:!0,children:F.map(s=>e.jsxs($,{value:s.id.toString(),children:[s.account_code," - ",s.account_name]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("From Date")}),e.jsx(C,{value:d,onChange:b,placeholder:t("Select from date")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("To Date")}),e.jsx(C,{value:n,onChange:y,placeholder:t("Select to date")})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(u,{onClick:B,disabled:!c||f,size:"sm",children:t(f?"Loading...":"Generate")}),e.jsx(u,{variant:"outline",onClick:P,size:"sm",children:t("Clear")}),r&&((D=(_=A.user)==null?void 0:_.permissions)==null?void 0:D.includes("print-general-ledger"))&&e.jsxs(u,{variant:"outline",size:"sm",onClick:E,className:"gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),t("Download PDF")]})]})]})}),r?e.jsxs(g,{className:"p-0",children:[p&&e.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[p.account_code," - ",p.account_name]}),d&&n&&e.jsxs("p",{className:"text-sm text-gray-600",children:[j(d)," ",t("to")," ",j(n)]})]}),e.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 max-h-[60vh] w-full",children:e.jsx("div",{className:"min-w-[900px]",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:t("Date")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:t("Description")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:t("Reference")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:t("Debit")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:t("Credit")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold",children:t("Balance")})]})}),e.jsxs("tbody",{children:[r.opening_balance!==0&&e.jsxs("tr",{className:"bg-blue-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-semibold",colSpan:5,children:t("Opening Balance")}),e.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold",children:m(r.opening_balance)})]}),r.transactions.length>0?r.transactions.map(s=>e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:j(s.date)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.description}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.reference_type}),e.jsx("td",{className:"px-4 py-3 text-sm text-right",children:s.debit>0?m(s.debit):"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-right",children:s.credit>0?m(s.credit):"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium",children:m(s.balance)})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8",children:e.jsx(w,{icon:k,title:t("No transactions found"),description:t("No transactions found for the selected account and date range."),className:"h-auto"})})}),r.transactions.length>0&&e.jsxs("tr",{className:"bg-gray-100 font-semibold sticky bottom-0",children:[e.jsx("td",{className:"px-4 py-3 text-sm",colSpan:5,children:t("Closing Balance")}),e.jsx("td",{className:"px-4 py-3 text-sm text-right",children:m(r.closing_balance)})]})]})]})})})]}):e.jsx(g,{className:"p-0",children:e.jsx(w,{icon:k,title:t("General Ledger Report"),description:t("Select an account and date range to generate the report"),className:"h-auto py-12"})})]})}export{je as default};
